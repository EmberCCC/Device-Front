{"ast":null,"code":"import \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/table/style\";\nimport _Table from \"antd/lib/table\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _objectSpread from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"F:\\\\documents\\\\bl-device-manage\\\\src\\\\layouts\\\\WorkManage\\\\OperatePage\\\\AddModal.js\";\n\nimport React, { Component } from 'react';\nimport { Form } from '@ant-design/compatible';\nimport '@ant-design/compatible/assets/index.css';\nimport { inject, observer } from 'mobx-react';\nvar Option = _Select.Option;\nvar formItemLayout = {\n  labelCol: {\n    span: 6\n  },\n  wrapperCol: {\n    span: 12\n  }\n};\nvar AddModal = (_dec = inject('WorkStore', 'DeviceDefineStore'), _dec(_class = observer(_class = (_temp =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AddModal, _Component);\n\n  function AddModal(props) {\n    var _this;\n\n    _classCallCheck(this, AddModal);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AddModal).call(this, props));\n\n    _this.onSelectedChange = function (selectedRowKeys) {\n      selectedRowKeys = [selectedRowKeys.pop()];\n\n      _this.setState({\n        selectedRowKeys: selectedRowKeys\n      });\n    };\n\n    _this.onOk = function () {\n      _this.props.form.validateFieldsAndScroll(function (err, values) {\n        if (!err) {\n          if (_this.state.selectedRowKeys.length > 0) {\n            _this.store.saveWork(_objectSpread({\n              id: _this.store.currentMain.id\n            }, values, {\n              workerId: _this.state.selectedRowKeys[0],\n              workStatus: _this.store.currentMain.workStatus.toString() === '0' ? 1 : 7,\n              deviceId: _this.store.currentMain.deviceId\n            }));\n\n            _this.props.onClose();\n          } else {\n            _message.error('必须选择一位维保人员');\n          }\n        }\n      });\n    };\n\n    _this.store = _this.props.WorkStore;\n    _this.state = {\n      selectedRowKeys: []\n    };\n    return _this;\n  }\n\n  _createClass(AddModal, [{\n    key: \"render\",\n    value: function render() {\n      var getFieldDecorator = this.props.form.getFieldDecorator;\n      var _this$props = this.props,\n          visible = _this$props.visible,\n          onClose = _this$props.onClose;\n      var currentMain = this.store.currentMain;\n      var employeeList = this.props.DeviceDefineStore.employeeList;\n      var columns = [{\n        title: '姓名',\n        dataIndex: 'name',\n        key: 'name'\n      }, {\n        title: '待接工单数',\n        dataIndex: 'count',\n        key: 'count'\n      }, {\n        title: '已接待完成数',\n        dataIndex: 'count2',\n        key: 'count2'\n      }];\n      var data = this.store.workDetailList;\n      return React.createElement(_Modal, {\n        title: '派单',\n        visible: visible,\n        onCancel: onClose,\n        footer: React.createElement(React.Fragment, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 50\n          },\n          __self: this\n        }, React.createElement(_Button, {\n          onClick: this.props.onClose,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 51\n          },\n          __self: this\n        }, \"\\u53D6\\u6D88\"), React.createElement(_Button, {\n          type: \"primary\",\n          onClick: this.onOk,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 52\n          },\n          __self: this\n        }, \"\\u786E\\u5B9A\")),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45\n        },\n        __self: this\n      }, React.createElement(Form, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      }, React.createElement(Form.Item, Object.assign({}, formItemLayout, {\n        label: \"\\u5DE5\\u5355\\u7F16\\u53F7\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      }), getFieldDecorator('workNo', {\n        initialValue: currentMain.workNo,\n        rules: [{\n          required: true,\n          message: '请输入工单编号'\n        }]\n      })(React.createElement(_Input, {\n        disabled: true,\n        placeholder: \"\\u8BF7\\u8F93\\u5165\",\n        style: {\n          width: '250px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }))), React.createElement(_Table, {\n        columns: columns,\n        size: \"middle\",\n        rowKey: \"id\",\n        dataSource: data,\n        pagination: false,\n        locale: {\n          emptyText: '暂无数据，请选择维保人员'\n        },\n        rowSelection: {\n          selectedRowKeys: this.state.selectedRowKeys,\n          onChange: this.onSelectedChange\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.store.getCountByWorkerId();\n    }\n  }]);\n\n  return AddModal;\n}(Component), _temp)) || _class) || _class);\nvar WrappedDynamicRule = Form.create({})(AddModal);\nexport default WrappedDynamicRule;","map":{"version":3,"sources":["F:\\documents\\bl-device-manage\\src\\layouts\\WorkManage\\OperatePage\\AddModal.js"],"names":["React","Component","Form","inject","observer","Option","formItemLayout","labelCol","span","wrapperCol","AddModal","props","onSelectedChange","selectedRowKeys","pop","setState","onOk","form","validateFieldsAndScroll","err","values","state","length","store","saveWork","id","currentMain","workerId","workStatus","toString","deviceId","onClose","error","WorkStore","getFieldDecorator","visible","employeeList","DeviceDefineStore","columns","title","dataIndex","key","data","workDetailList","initialValue","workNo","rules","required","message","width","emptyText","onChange","getCountByWorkerId","WrappedDynamicRule","create"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Form } from '@ant-design/compatible';\r\nimport '@ant-design/compatible/assets/index.css';\r\nimport { Input, Button, Select, Modal, Table, message } from 'antd';\r\nimport { inject, observer } from 'mobx-react';\r\nconst { Option } = Select;\r\n\r\nconst formItemLayout = {\r\n  labelCol: { span: 6 },\r\n  wrapperCol: { span: 12 },\r\n};\r\n@inject('WorkStore', 'DeviceDefineStore')\r\n@observer\r\nclass AddModal extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.store = this.props.WorkStore;\r\n    this.state = {\r\n      selectedRowKeys : []\r\n    }\r\n  }\r\n  render() {\r\n    const { getFieldDecorator } = this.props.form;\r\n    const { visible, onClose } = this.props;\r\n    const { currentMain, } = this.store;\r\n    const { employeeList } = this.props.DeviceDefineStore\r\n    const columns = [\r\n      {\r\n        title: '姓名',\r\n        dataIndex: 'name',\r\n        key: 'name'\r\n      },\r\n      {\r\n        title: '待接工单数',\r\n        dataIndex: 'count',\r\n        key: 'count'\r\n      },\r\n      {\r\n        title: '已接待完成数',\r\n        dataIndex: 'count2',\r\n        key: 'count2'\r\n      },\r\n    ];\r\n    const data = this.store.workDetailList\r\n    return <Modal\r\n      title={'派单'}\r\n      visible={visible}\r\n      onCancel={onClose}\r\n      footer={\r\n        <React.Fragment>\r\n          <Button onClick={this.props.onClose}>取消</Button>\r\n          <Button type='primary' onClick={this.onOk}>确定</Button>\r\n        </React.Fragment>\r\n      }\r\n    >\r\n      <Form>\r\n        <Form.Item {...formItemLayout} label=\"工单编号\">\r\n          {getFieldDecorator('workNo', {\r\n            initialValue: currentMain.workNo,\r\n            rules: [\r\n              {\r\n                required: true,\r\n                message: '请输入工单编号'\r\n              }\r\n            ]\r\n          })(\r\n            <Input disabled placeholder='请输入' style={{ width: '250px' }} />\r\n          )}\r\n        </Form.Item>\r\n\r\n        {/* <Form.Item {...formItemLayout} label=\"维保人员\">\r\n          {getFieldDecorator('workerId', {\r\n            initialValue: currentMain.workerId,\r\n            rules: [\r\n              {\r\n                required: true,\r\n                message: '请输入维保人员'\r\n              }\r\n            ]\r\n          })(\r\n            <Select\r\n              showSearch allowClear\r\n              optionFilterProp='children'\r\n              placeholder=\"请选择维保人员\"\r\n              style={{ width: 250 }}\r\n              onChange={this.getWorkerDetail}\r\n            >\r\n              {\r\n                employeeList.map(mas => <Option key={mas.id} value={mas.id}>{mas.name}</Option>)\r\n              }\r\n            </Select>\r\n          )}\r\n        </Form.Item> */}\r\n        <Table \r\n          columns={columns} \r\n          size='middle' \r\n          rowKey='id'\r\n          dataSource={data} \r\n          pagination={false} \r\n          locale = {{emptyText:'暂无数据，请选择维保人员'}}\r\n          rowSelection = {{\r\n            selectedRowKeys:this.state.selectedRowKeys,\r\n            onChange:this.onSelectedChange\r\n          }}\r\n        />\r\n      </Form>\r\n    </Modal>\r\n  }\r\n  onSelectedChange = selectedRowKeys =>{\r\n    selectedRowKeys = [selectedRowKeys.pop()]\r\n    this.setState({\r\n      selectedRowKeys\r\n    })\r\n  }\r\n  // getWorkerDetail = (e) => {\r\n  //   console.log(e)\r\n  //   this.props.DeviceDefineStore.employeeList.map(mas => {\r\n  //     if (e === mas.id) this.store.workerName = mas.name\r\n  //   })\r\n  //   this.store.getCountByWorkerId({ workerId: e })\r\n  // }\r\n  onOk = () => {\r\n    this.props.form.validateFieldsAndScroll((err, values) => {\r\n      if (!err) {\r\n        if(this.state.selectedRowKeys.length > 0 ){\r\n          this.store.saveWork({\r\n            id: this.store.currentMain.id,\r\n            ...values,\r\n            workerId:this.state.selectedRowKeys[0],\r\n            workStatus: this.store.currentMain.workStatus.toString() === '0' ? 1 : 7,\r\n            deviceId: this.store.currentMain.deviceId,\r\n          })\r\n          this.props.onClose();\r\n        }else{\r\n          message.error('必须选择一位维保人员')\r\n        }\r\n      }\r\n    });\r\n  }\r\n  componentDidMount() {\r\n    this.store.getCountByWorkerId()\r\n  }\r\n}\r\nconst WrappedDynamicRule = Form.create({})(AddModal);\r\nexport default WrappedDynamicRule;"]},"metadata":{},"sourceType":"module"}