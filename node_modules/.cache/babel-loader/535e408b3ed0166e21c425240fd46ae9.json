{"ast":null,"code":"import \"antd/lib/drawer/style\";\nimport _Drawer from \"antd/lib/drawer\";\nimport _defineProperty from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport \"antd/lib/layout/style\";\nimport _Layout from \"antd/lib/layout\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/src/layouts/HomeLayout/index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { toJS } from 'mobx';\nimport { isEmpty } from 'lodash';\nimport { ContainerQuery } from 'react-container-query';\nimport classnames from 'classnames';\nimport { withRouter } from 'react-router-dom';\nimport Menu from './Menu';\nimport GlobalHeader from 'components/GlobalHeader';\nimport GlobalCrumbs from 'components/GlobalCrumbs';\nimport Context from './AllContext';\nimport { Media_Query, s_size, m_size, l_size } from 'constants/configs';\nimport { judgeIsMobile } from 'utils/dataTools';\nimport ErrorNotFound from './ErrorNotFound';\nimport './index.less';\nvar Content = _Layout.Content;\nvar HomeLayout = (_dec = inject('HomeStore'), withRouter(_class = _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_Component) {\n  _inherits(HomeLayout, _Component);\n\n  var _super = _createSuper(HomeLayout);\n\n  function HomeLayout() {\n    var _this;\n\n    _classCallCheck(this, HomeLayout);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      collapsed: false,\n      firstMount: false\n    };\n\n    _this.getMediaQuery = function (params) {\n      var current;\n\n      for (var key in params) {\n        if (params[key]) {\n          current = key;\n        }\n      }\n\n      if (s_size.includes(current)) {\n        _this.props.HomeStore.changeValue('size_class', 's_size');\n      } else if (m_size.includes(current)) {\n        _this.props.HomeStore.changeValue('size_class', 'm_size');\n      } else if (l_size.includes(current)) {\n        _this.props.HomeStore.changeValue('size_class', 'l_size');\n      }\n    };\n\n    _this.getContext = function () {\n      var _this$props = _this.props,\n          location = _this$props.location,\n          breadcrumbNameMap = _this$props.breadcrumbNameMap;\n      return _objectSpread({\n        location: location,\n        breadcrumbNameMap: breadcrumbNameMap\n      }, _this.props);\n    };\n\n    _this.getLastMenu = function () {\n      var list = sessionStorage.getItem('menu') || [];\n      if (!isEmpty(list)) list = JSON.parse(list).reverse();\n      return list || [];\n    };\n\n    _this.toggle = function () {\n      _this.props.HomeStore.changeValue('collapsed', !_this.props.HomeStore.collapsed);\n\n      _this.props.HomeStore.changeValue('isClickCollapsed', true);\n    };\n\n    _this.toggleMenu = function (actionId) {\n      _this.props.HomeStore.toggleMenu({\n        actionId: actionId\n      }, function (url) {\n        if (url) {\n          _this.props.history.push(url);\n        } else {\n          alert('false');\n        }\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(HomeLayout, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this,\n          _React$createElement;\n\n      var isHome = window.location.pathname === '/index';\n      var isMobile = judgeIsMobile(this.props.type).toString();\n\n      var _toJS = toJS(this.props.HomeStore),\n          size_class = _toJS.size_class;\n\n      var isAuth = true;\n      var layout = /*#__PURE__*/React.createElement(_Layout, {\n        className: \"home_layout\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 33,\n          columnNumber: 20\n        }\n      }, isAuth && !isHome && (size_class === 's_size' ? /*#__PURE__*/React.createElement(_Drawer, {\n        visible: this.state.firstMount ? false : !this.props.HomeStore.collapsed,\n        placement: \"left\",\n        onClose: this.toggle,\n        width: \"200px\",\n        style: {\n          padding: 0,\n          height: '100vh'\n        },\n        bodyStyle: {\n          height: '100%',\n          padding: '0'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Menu, {\n        sizetype: size_class,\n        mobile: isMobile,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 13\n        }\n      })) : /*#__PURE__*/React.createElement(Menu, {\n        sizetype: size_class,\n        mobile: isMobile,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(_Layout, {\n        className: \"right_layout\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(GlobalHeader, (_React$createElement = {\n        isAuth: isAuth,\n        sizetype: size_class,\n        mobile: isMobile,\n        ishome: isHome\n      }, _defineProperty(_React$createElement, \"sizetype\", size_class), _defineProperty(_React$createElement, \"mobile\", isMobile), _defineProperty(_React$createElement, \"dataSource\", toJS(this.props.HomeStore.crumbsList)), _defineProperty(_React$createElement, \"backToLogin\", function backToLogin() {\n        _this2.props.history.push('/login');\n      }), _defineProperty(_React$createElement, \"visible\", this.props.HomeStore.collapsed), _defineProperty(_React$createElement, \"toggle\", this.toggle), _defineProperty(_React$createElement, \"__self\", this), _defineProperty(_React$createElement, \"__source\", {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }), _React$createElement)), /*#__PURE__*/React.createElement(Content, {\n        style: {\n          margin: '8px',\n          padding: 15,\n          background: '#fff',\n          minHeight: 280,\n          overflowY: 'auto',\n          position: 'relative'\n        },\n        id: \"home_content\",\n        mobile: isMobile,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 9\n        }\n      }, isAuth ? this.props.children : /*#__PURE__*/React.createElement(ErrorNotFound, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 44\n        }\n      }))));\n      return /*#__PURE__*/React.createElement(\"div\", {\n        id: \"Assets\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(ContainerQuery, {\n        query: Media_Query,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 9\n        }\n      }, function (params) {\n        _this2.getMediaQuery(params);\n\n        return /*#__PURE__*/React.createElement(Context.Provider, {\n          value: _this2.getContext(),\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: classnames(params),\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }\n        }, layout));\n      }));\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      this.setState({\n        firstMount: true\n      });\n      /* 进入即请求菜单 */\n\n      if (this.props.history.location.pathname !== '/login') {\n        this.props.HomeStore.getMenuList().then(function (url) {\n          if (_this3.props.history.location.pathname.indexOf('index') === -1) {\n            _this3.props.history.push(url);\n\n            _this3.props.HomeStore.initMenu(_this3.props.history.location.pathname);\n          }\n        });\n      }\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      return {\n        firstMount: false\n      };\n    }\n  }]);\n\n  return HomeLayout;\n}(Component), _temp)) || _class) || _class) || _class);\nexport default HomeLayout;","map":{"version":3,"sources":["/Users/shoen/Desktop/设备运维前端/bl-device-manage/src/layouts/HomeLayout/index.js"],"names":["React","Component","inject","observer","toJS","isEmpty","ContainerQuery","classnames","withRouter","Menu","GlobalHeader","GlobalCrumbs","Context","Media_Query","s_size","m_size","l_size","judgeIsMobile","ErrorNotFound","Content","HomeLayout","state","collapsed","firstMount","getMediaQuery","params","current","key","includes","props","HomeStore","changeValue","getContext","location","breadcrumbNameMap","getLastMenu","list","sessionStorage","getItem","JSON","parse","reverse","toggle","toggleMenu","actionId","url","history","push","alert","isHome","window","pathname","isMobile","type","toString","size_class","isAuth","layout","padding","height","crumbsList","margin","background","minHeight","overflowY","position","children","setState","getMenuList","then","indexOf","initMenu"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { toJS } from 'mobx';\nimport { isEmpty } from 'lodash';\nimport { ContainerQuery } from 'react-container-query';\nimport classnames from 'classnames';\nimport { withRouter } from 'react-router-dom';\nimport Menu from './Menu';\nimport GlobalHeader from 'components/GlobalHeader';\nimport GlobalCrumbs from 'components/GlobalCrumbs';\nimport Context from './AllContext';\nimport { Media_Query, s_size, m_size, l_size } from 'constants/configs';\nimport { Layout, Drawer } from 'antd';\nimport { judgeIsMobile } from 'utils/dataTools';\nimport ErrorNotFound from './ErrorNotFound';\nimport './index.less';\n\nconst { Content } = Layout;\n@withRouter\n@inject('HomeStore')\n@observer\nclass HomeLayout extends Component {\n  state = {\n    collapsed: false,\n    firstMount: false\n  };\n\n  render() {\n    const isHome = window.location.pathname === '/index';\n    const isMobile = judgeIsMobile(this.props.type).toString();\n    const { size_class, } = toJS(this.props.HomeStore);\n    const isAuth = true;\n    const layout = <Layout className='home_layout'>\n      {\n        isAuth && !isHome && (size_class === 's_size' ?\n          <Drawer\n            visible={this.state.firstMount ? false : !this.props.HomeStore.collapsed}\n            placement=\"left\"\n            onClose={this.toggle}\n            width='200px'\n            style={{\n              padding: 0,\n              height: '100vh',\n            }}\n            bodyStyle={{\n              height: '100%',\n              padding: '0'\n            }}\n          >\n            <Menu sizetype={size_class} mobile={isMobile} />\n          </Drawer>\n          : <Menu sizetype={size_class} mobile={isMobile} />)\n      }\n      <Layout className='right_layout'>\n        {/*isAuth && !isHome && <GlobalCrumbs\n          sizetype={size_class}\n          mobile={isMobile}\n          toIndex={e => this.props.history.push('/index')}\n        dataSource={toJS(this.props.HomeStore.crumbsList)} />*/}\n        <GlobalHeader\n          isAuth={isAuth}\n          sizetype={size_class}\n          mobile={isMobile}\n          ishome={isHome}\n          sizetype={size_class}\n          mobile={isMobile}\n          dataSource={toJS(this.props.HomeStore.crumbsList)}\n          backToLogin={() => { this.props.history.push('/login') }}\n          visible={this.props.HomeStore.collapsed} toggle={this.toggle} />\n\n        <Content\n          style={{\n            margin: '8px', padding: 15, background: '#fff', minHeight: 280,\n            overflowY: 'auto', position: 'relative'\n          }}\n          id='home_content'\n          mobile={isMobile}\n        >\n\n          {(isAuth ? this.props.children : <ErrorNotFound />)}\n        </Content>\n      </Layout>\n    </Layout>;\n    return (\n      <div id='Assets'>\n        <ContainerQuery query={Media_Query}>\n          {params => {\n            this.getMediaQuery(params);\n            return <Context.Provider value={this.getContext()}>\n              <div className={classnames(params)}>\n                {layout}\n              </div>\n            </Context.Provider>\n          }}\n        </ContainerQuery>\n\n      </div>\n    );\n  }\n  getMediaQuery = (params) => {\n    let current;\n    for (let key in params) {\n      if (params[key]) {\n        current = key;\n      }\n    }\n    if (s_size.includes(current)) {\n      this.props.HomeStore.changeValue('size_class', 's_size');\n    } else if (m_size.includes(current)) {\n      this.props.HomeStore.changeValue('size_class', 'm_size');\n    } else if (l_size.includes(current)) {\n      this.props.HomeStore.changeValue('size_class', 'l_size');\n    }\n  }\n  getContext = () => {\n    const { location, breadcrumbNameMap } = this.props;\n    return {\n      location,\n      breadcrumbNameMap,\n      ...this.props\n    };\n  }\n  getLastMenu = () => {\n    let list = sessionStorage.getItem('menu') || [];\n    if (!isEmpty(list))\n      list = JSON.parse(list).reverse();\n    return list || [];\n  }\n\n  toggle = () => {\n    this.props.HomeStore.changeValue('collapsed', !this.props.HomeStore.collapsed);\n    this.props.HomeStore.changeValue('isClickCollapsed', true);\n  }\n  toggleMenu = (actionId) => {\n    this.props.HomeStore.toggleMenu({ actionId }, (url) => {\n      if (url) {\n        this.props.history.push(url);\n      } else {\n        alert('false');\n      }\n    });\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      firstMount: false,\n    }\n  }\n  componentDidMount() {\n    this.setState({\n      firstMount: true\n    });\n    /* 进入即请求菜单 */\n    if (this.props.history.location.pathname !== '/login') {\n      this.props.HomeStore.getMenuList().then((url) => {\n        if (this.props.history.location.pathname.indexOf('index') === -1) {\n          this.props.history.push(url)\n          this.props.HomeStore.initMenu(this.props.history.location.pathname)\n        }\n      })\n    }\n  }\n}\nexport default HomeLayout;"]},"metadata":{},"sourceType":"module"}