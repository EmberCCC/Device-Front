{"ast":null,"code":"/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-05 10:16:45\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-05 12:24:23\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormEdit\\changeTool.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\nimport { firstFormName } from \"constants/status_constant\";\nexport function exChange(item, firstFormId) {\n  var params = {};\n  var pro = {};\n  var subForms = [];\n  params.formId = firstFormId;\n  params.formName = firstFormName[firstFormId];\n\n  for (var key in item) {\n    if (key != 'properties') {\n      pro[key] = item[key];\n    } else {\n      var field = [];\n      var obj = {};\n      obj['name'] = 'root';\n\n      for (var keyP in item[key]) {\n        var iObj = {};\n\n        if (keyP.hasOwnProperty('fieldId')) {\n          iObj['fieldId'] = keyP['fieldId'];\n        }\n\n        iObj['name'] = keyP;\n        iObj['typeId'] = keyP.split('_')[0];\n        iObj['detailJson'] = item[key][keyP];\n        field.push(iObj);\n      }\n\n      obj['fields'] = field;\n      subForms.push(obj);\n    }\n  }\n\n  params['properties'] = pro;\n  params['subForms'] = subForms;\n  return params;\n}\n\nfunction getOneForm(fields, fieldIds) {\n  var result = {};\n  fieldIds.forEach(function (item) {\n    fields.forEach(function (field) {\n      if (field['id'] == item) {\n        var detailJson = JSON.parse(field['detailJson']);\n        result[field['name']] = detailJson;\n      }\n    });\n  });\n  console.log(result);\n  return result;\n}\n\nexport function restore(obj) {\n  var formItem = {};\n  console.log(obj);\n  var fieldInfo = JSON.parse(obj['form']['formFields']);\n  var properties = JSON.parse(obj['form']['properties']);\n  var fields = obj['fields'];\n\n  for (var index = 0; index < fieldInfo.length; index++) {\n    var element = fieldInfo[index];\n    console.log(element);\n\n    if (element['name'] == 'root') {\n      formItem['properties'] = getOneForm(fields, element['fieldsId']);\n    }\n  }\n\n  for (var key in properties) {\n    if (Object.hasOwnProperty.call(properties, key)) {\n      var _element = properties[key];\n      formItem[key] = _element;\n    }\n  }\n\n  console.log(fields);\n  console.log(fieldInfo);\n  console.log(properties);\n  console.log(formItem);\n  console.log(obj);\n}","map":{"version":3,"names":["firstFormName","exChange","item","firstFormId","params","pro","subForms","formId","formName","key","field","obj","keyP","iObj","hasOwnProperty","split","push","getOneForm","fields","fieldIds","result","forEach","detailJson","JSON","parse","console","log","restore","formItem","fieldInfo","properties","index","length","element","Object","call"],"sources":["F:/documents/bl-device-manage-test/src/layouts/FormEdit/changeTool.js"],"sourcesContent":["/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-05 10:16:45\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-05 12:24:23\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormEdit\\changeTool.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\r\nimport { firstFormName } from \"constants/status_constant\";\r\n\r\nexport function exChange(item, firstFormId) {\r\n  let params = {};\r\n  let pro = {};\r\n  let subForms = [];\r\n  params.formId = firstFormId;\r\n  params.formName = firstFormName[firstFormId]\r\n  for (const key in item) {\r\n    if (key != 'properties') {\r\n      pro[key] = item[key];\r\n    } else {\r\n      let field = [];\r\n      let obj = {};\r\n      obj['name'] = 'root';\r\n      for (const keyP in item[key]) {\r\n        let iObj = {};\r\n        if (keyP.hasOwnProperty('fieldId')) {\r\n          iObj['fieldId'] = keyP['fieldId'];\r\n        }\r\n        iObj['name'] = keyP\r\n        iObj['typeId'] = keyP.split('_')[0]\r\n        iObj['detailJson'] = item[key][keyP]\r\n        field.push(iObj);\r\n      }\r\n      obj['fields'] = field\r\n      subForms.push(obj)\r\n    }\r\n  }\r\n  params['properties'] = pro\r\n  params['subForms'] = subForms\r\n  return params;\r\n}\r\n\r\nfunction getOneForm(fields,fieldIds){\r\n  let result = {}\r\n  fieldIds.forEach(item => {\r\n    fields.forEach(field => {\r\n      if(field['id'] == item){\r\n        const detailJson = JSON.parse(field['detailJson']);\r\n        result[field['name']] = detailJson;\r\n      }\r\n    });\r\n  });\r\n  console.log(result);\r\n  return result\r\n}\r\nexport function restore(obj) {\r\n  let formItem = {}\r\n  console.log(obj);\r\n  const fieldInfo = JSON.parse(obj['form']['formFields']);\r\n  const properties = JSON.parse(obj['form']['properties']);\r\n  const fields = obj['fields'];\r\n  for (let index = 0; index < fieldInfo.length; index++) {\r\n    const element = fieldInfo[index];\r\n    console.log(element);\r\n    if (element['name'] == 'root') {\r\n      formItem['properties'] = getOneForm(fields,element['fieldsId'])\r\n    }\r\n  }\r\n  for (const key in properties) {\r\n    if (Object.hasOwnProperty.call(properties, key)) {\r\n      const element = properties[key];\r\n      formItem[key] = element\r\n    }\r\n  }\r\n  console.log(fields);\r\n  console.log(fieldInfo);\r\n  console.log(properties);\r\n  console.log(formItem);\r\n  console.log(obj);\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}