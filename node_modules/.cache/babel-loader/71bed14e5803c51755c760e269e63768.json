{"ast":null,"code":"import \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/table/style\";\nimport _Table from \"antd/lib/table\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport _defineProperty from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/Users/shoen/Desktop/\\u8BBE\\u5907\\u8FD0\\u7EF4\\u524D\\u7AEF/bl-device-manage/src/layouts/BasicManage/MaintainPage/Inspect/SchemaMenu.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { toJS } from 'mobx';\nimport GlobalList from 'components/GlobalList';\nimport { setSchemaColumns, setSchemaFormColumns, setSchemaModalColumns } from '../cell/methods';\nimport { DraggableArea } from 'react-draggable-tags';\nvar SchemaMenu = (_dec = inject('DeviceMaintainStore'), _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_Component) {\n  _inherits(SchemaMenu, _Component);\n\n  var _super = _createSuper(SchemaMenu);\n\n  function SchemaMenu(props) {\n    var _this;\n\n    _classCallCheck(this, SchemaMenu);\n\n    _this = _super.call(this, props);\n\n    _this.handleDetail = function (id) {\n      _this.store.status = 'query';\n\n      _this.store.getInfo({\n        id: id\n      }, 'server').then(function () {\n        _this.store.editVisible = !_this.store.editVisible;\n      });\n    };\n\n    _this.handleStatus = function (record) {\n      _this.store.save({\n        id: record.id,\n        planStatus: record.planStatus === 1 ? 0 : 1,\n        maintainType: 2\n      }, 'schema');\n    };\n\n    _this.handleVisible = function () {\n      /* 每次打开弹窗 获取所有的巡检列表 */\n      if (!_this.state.visible) {\n        _this.store.getMaintainServer({}).then(function () {\n          if (_this.store.status == 'edit') {\n            _this.state.tags = [];\n            _this.store.currentMainSchame.contentIds && _this.store.currentMainSchame.contentIds.split(',').map(function (item) {\n              var tag = toJS(_this.store.serverList).filter(function (tag) {\n                return tag.id === parseInt(item);\n              })[0];\n\n              _this.state.tags.push(tag);\n            });\n          } else {\n            _this.state.tags = [];\n            _this.state.modalSelectedRowKeys = [];\n          }\n\n          _this.setState({});\n        });\n      }\n\n      if (_this.state.visible) {\n        _this.state = _objectSpread({}, _this.state, {\n          selectedRowKeys: [],\n          modalSelectedRowKeys: [],\n          //弹窗内部的选项\n          tags: []\n        });\n      }\n\n      _this.setState({\n        visible: !_this.state.visible\n      });\n    };\n\n    _this.onModalItemSelect = function (selectedRowKeys) {\n      _this.state.tags = [];\n      selectedRowKeys.map(function (item) {\n        var tag = toJS(_this.store.serverList).filter(function (tag) {\n          return tag.id === item;\n        })[0];\n\n        _this.state.tags.push(tag);\n      });\n\n      _this.setState({\n        modalSelectedRowKeys: selectedRowKeys\n      });\n    };\n\n    _this.changeTag = function (tags) {\n      _this.setState({\n        tags: tags\n      });\n    };\n\n    _this.handleClickDelete = function (tag) {\n      var tags = _this.state.tags.filter(function (t) {\n        return tag.id !== t.id;\n      });\n\n      var selectedRowKeys = [];\n      tags.map(function (item) {\n        selectedRowKeys.push(item.id);\n      });\n\n      _this.setState({\n        tags: tags,\n        modalSelectedRowKeys: selectedRowKeys\n      });\n    };\n\n    _this.handleSubmit = function (values) {\n      var _this$store = _this.store,\n          deviceType = _this$store.deviceType,\n          status = _this$store.status,\n          currentMainSchame = _this$store.currentMainSchame,\n          maintainType = _this$store.maintainType;\n      var tags = _this.state.tags;\n      _this.state.modalSelectedRowKeys = [];\n      tags.map(function (item) {\n        _this.state.modalSelectedRowKeys.push(item.id);\n      });\n\n      var params = _objectSpread({\n        deviceType: deviceType,\n        contentIds: _this.state.modalSelectedRowKeys.join(','),\n        maintainType: maintainType\n      }, values);\n\n      if (status !== 'add') {\n        params.id = currentMainSchame.id;\n      }\n\n      _this.store.save(params, 'schema');\n\n      _this.handleVisible();\n    };\n\n    _this.handleEdit = function (value) {\n      _this.store.status = 'edit';\n\n      _this.store.getInfo({\n        id: value\n      }, 'schema').then(function () {\n        var data = _this.store.currentMainSchame.contentIds.split(','),\n            newDs = [];\n\n        data.map(function (item) {\n          newDs.push(parseFloat(item));\n        });\n\n        _this.setState({\n          modalSelectedRowKeys: newDs\n        }, function () {\n          _this.handleVisible();\n        });\n      });\n    };\n\n    _this.handleDelete = function (_ref) {\n      var type = _ref.type,\n          value = _ref.value;\n\n      if (type === 'batch') {\n        if (_this.state.selectedRowKeys.length < 1) {\n          _Modal.warn({\n            title: '提示',\n            content: '请选择需要删除的内容'\n          });\n        } else {\n          _Modal.confirm({\n            title: '提示',\n            content: '确定删除选中的' + _this.state.selectedRowKeys.length + '条巡检内容？',\n            okText: '确定',\n            cancelText: '取消',\n            onOk: function onOk() {\n              _this.store.delete({\n                ids: _this.state.selectedRowKeys\n              }, 'schema');\n            }\n          });\n        }\n      } else {\n        _Modal.confirm({\n          title: '提示',\n          content: '确定删除当前巡检内容？',\n          okText: '确定',\n          cancelText: '取消',\n          onOk: function onOk() {\n            _this.store.delete({\n              id: value\n            }, 'schema');\n          }\n        });\n      }\n    };\n\n    _this.handleSelect = function (selectedRowKeys) {\n      _this.setState({\n        selectedRowKeys: selectedRowKeys\n      });\n    };\n\n    _this.handleCheckTag = function (tag) {\n      _this.store.deviceType = tag.id;\n\n      _this.store.getMaintainSchema({\n        typeId: tag.id\n      });\n    };\n\n    _this.store = _this.props.DeviceMaintainStore;\n    _this.state = {\n      selectedRowKeys: [],\n      modalSelectedRowKeys: [],\n      //弹窗内部的选项\n      visible: false,\n      tags: []\n    };\n    return _this;\n  }\n\n  _createClass(SchemaMenu, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$store2 = this.store,\n          schemaList = _this$store2.schemaList,\n          schemaPage = _this$store2.schemaPage,\n          serverList = _this$store2.serverList,\n          deviceList = _this$store2.deviceList,\n          isLoading = _this$store2.isLoading,\n          status = _this$store2.status,\n          currentMainSchame = _this$store2.currentMainSchame;\n      var rowSelection = {\n        selectedRowKeys: this.state.selectedRowKeys,\n        onChange: this.handleSelect\n      };\n      return /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          marginTop: '10px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 37,\n          columnNumber: 4\n        }\n      }, /*#__PURE__*/React.createElement(GlobalList, {\n        checkedTag: {\n          dataSource: deviceList,\n          title: '设备类型',\n          PopoVisible: false,\n          keyName: 'typeName',\n          defaultActiveKey: deviceList[0],\n          content: deviceList,\n          onClick: this.handleCheckTag\n        },\n        table: {\n          rowKey: 'id',\n          columns: setSchemaColumns({\n            handleDelete: this.handleDelete,\n            handleEdit: this.handleEdit,\n            handleStatus: this.handleStatus\n          }),\n          dataSource: schemaList,\n          pagination: _objectSpread({}, schemaPage, {\n            onChange: function onChange(pageIndex, pageSize) {\n              _this2.store.getScheme({\n                pageIndex: pageIndex,\n                pageSize: pageSize\n              });\n            }\n          }),\n          loading: isLoading,\n          rowSelection: rowSelection,\n          btns: [{\n            name: /*#__PURE__*/React.createElement(\"div\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 67,\n                columnNumber: 15\n              }\n            }, /*#__PURE__*/React.createElement(\"i\", {\n              className: \"iconfont icon-add icon-spacing\",\n              style: {\n                fontSize: '12px'\n              },\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 67,\n                columnNumber: 20\n              }\n            }), \"\\u65B0\\u589E\"),\n            onClick: function onClick() {\n              _this2.store.status = 'add';\n\n              _this2.handleVisible();\n            },\n            type: 'primary',\n            className: 'add-btn'\n          } // {\n          // \tname: '删除',\n          // \tonClick: () => this.handleDelete({type:'batch'})\n          // }\n          ]\n        },\n        modal: {\n          visible: this.state.visible,\n          title: status === 'add' ? '新增' : '编辑',\n          onCancel: this.handleVisible,\n          onOk: this.handleSubmit,\n          isForm: true,\n          formColumns: setSchemaFormColumns({\n            status: status,\n            currentMain: currentMainSchame,\n            maintainType: 2\n          }),\n          width: 700,\n          otherContent: /*#__PURE__*/React.createElement(\"div\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 26\n            }\n          }, /*#__PURE__*/React.createElement(_Table, {\n            scroll: {\n              y: 300\n            },\n            rowKey: \"id\",\n            columns: setSchemaModalColumns({\n              handleDetail: this.handleDetail,\n              contentLabel: '巡检内容',\n              contentTypeLabel: '巡检类型'\n            }),\n            dataSource: serverList,\n            rowSelection: {\n              selectedRowKeys: this.state.modalSelectedRowKeys,\n              onChange: this.onModalItemSelect,\n              selection: {\n                key: 'id',\n                text: 'name'\n              }\n            },\n            pagination: false,\n            size: \"small\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 15\n            }\n          }), this.state.tags.length > 0 && [/*#__PURE__*/React.createElement(\"div\", {\n            style: {\n              fontSize: '14px',\n              fontWeight: '600',\n              padding: '10px'\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 10\n            }\n          }, /*#__PURE__*/React.createElement(_Icon, {\n            style: {\n              marginRight: '5px',\n              color: '#6236FF'\n            },\n            type: \"info-circle\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 11\n            }\n          }), \"\\u663E\\u793A\\u987A\\u5E8F\"), /*#__PURE__*/React.createElement(\"div\", {\n            className: \"Simple-2\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 10\n            }\n          }, /*#__PURE__*/React.createElement(DraggableArea, {\n            tags: this.state.tags,\n            render: function render(_ref2) {\n              var tag = _ref2.tag,\n                  index = _ref2.index;\n              return /*#__PURE__*/React.createElement(\"div\", {\n                className: \"tag\",\n                key: index,\n                __self: _this2,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 119,\n                  columnNumber: 13\n                }\n              }, /*#__PURE__*/React.createElement(\"img\", {\n                src: require('../../../../assets/delete.png'),\n                alt: \"delete\",\n                className: \"delete\",\n                onClick: function onClick() {\n                  return _this2.handleClickDelete(tag);\n                },\n                __self: _this2,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 14\n                }\n              }), tag.content);\n            },\n            onChange: this.changeTag,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 11\n            }\n          }))])\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 5\n        }\n      }));\n    }\n    /* 点击查看库中每项内容的详情 */\n\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.store.getMaintainSchema({\n        typeId: this.store.deviceType\n      });\n    }\n  }]);\n\n  return SchemaMenu;\n}(Component), _temp)) || _class) || _class);\nexport default SchemaMenu;","map":{"version":3,"sources":["/Users/shoen/Desktop/设备运维前端/bl-device-manage/src/layouts/BasicManage/MaintainPage/Inspect/SchemaMenu.js"],"names":["React","Component","inject","observer","toJS","GlobalList","setSchemaColumns","setSchemaFormColumns","setSchemaModalColumns","DraggableArea","SchemaMenu","props","handleDetail","id","store","status","getInfo","then","editVisible","handleStatus","record","save","planStatus","maintainType","handleVisible","state","visible","getMaintainServer","tags","currentMainSchame","contentIds","split","map","item","tag","serverList","filter","parseInt","push","modalSelectedRowKeys","setState","selectedRowKeys","onModalItemSelect","changeTag","handleClickDelete","t","handleSubmit","values","deviceType","params","join","handleEdit","value","data","newDs","parseFloat","handleDelete","type","length","warn","title","content","confirm","okText","cancelText","onOk","delete","ids","handleSelect","handleCheckTag","getMaintainSchema","typeId","DeviceMaintainStore","schemaList","schemaPage","deviceList","isLoading","rowSelection","onChange","marginTop","dataSource","PopoVisible","keyName","defaultActiveKey","onClick","rowKey","columns","pagination","pageIndex","pageSize","getScheme","loading","btns","name","fontSize","className","onCancel","isForm","formColumns","currentMain","width","otherContent","y","contentLabel","contentTypeLabel","selection","key","text","fontWeight","padding","marginRight","color","index","require"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { toJS } from 'mobx';\nimport GlobalList from 'components/GlobalList';\nimport { Modal, Table ,Icon } from 'antd';\nimport { setSchemaColumns,setSchemaFormColumns, setSchemaModalColumns, } from '../cell/methods';\nimport { DraggableArea } from 'react-draggable-tags';\n\n@inject('DeviceMaintainStore')\n@observer\nclass SchemaMenu extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.store = this.props.DeviceMaintainStore;\n\t\tthis.state = {\n      selectedRowKeys: [],\n      modalSelectedRowKeys :[], //弹窗内部的选项\n\t\t\tvisible: false,\n\t\t\ttags:[]\n\t\t};\n\t}\n\trender() {\n\t\tconst {\n\t\t\tschemaList,\n      schemaPage,\n      serverList,\n\t\t\tdeviceList,\n\t\t\tisLoading,\n\t\t\tstatus,\n\t\t\tcurrentMainSchame\n\t\t} = this.store;\n\t\tconst rowSelection = {\n\t\t\tselectedRowKeys: this.state.selectedRowKeys,\n\t\t\tonChange: this.handleSelect\n    };\n\t\treturn (\n\t\t\t<div style={{marginTop:'10px'}}>\n\t\t\t\t<GlobalList\n\t\t\t\t\tcheckedTag={{\n\t\t\t\t\t\tdataSource: deviceList,\n\t\t\t\t\t\ttitle: '设备类型',\n\t\t\t\t\t\tPopoVisible: false,\n\t\t\t\t\t\tkeyName: 'typeName',\n\t\t\t\t\t\tdefaultActiveKey: deviceList[0],\n\t\t\t\t\t\tcontent: deviceList,\n\t\t\t\t\t\tonClick: this.handleCheckTag\n\t\t\t\t\t}}\n\t\t\t\t\ttable={{\n\t\t\t\t\t\trowKey: 'id',\n            columns: setSchemaColumns({\n              handleDelete:this.handleDelete,handleEdit:this.handleEdit,handleStatus:this.handleStatus\n            }),\n\t\t\t\t\t\tdataSource: schemaList,\n\t\t\t\t\t\tpagination: {\n\t\t\t\t\t\t\t...schemaPage,\n\t\t\t\t\t\t\tonChange: (pageIndex, pageSize) => {\n\t\t\t\t\t\t\t\tthis.store.getScheme({\n\t\t\t\t\t\t\t\t\tpageIndex,\n\t\t\t\t\t\t\t\t\tpageSize,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tloading: isLoading,\n\t\t\t\t\t\trowSelection,\n\t\t\t\t\t\tbtns: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: <div><i className=\"iconfont icon-add icon-spacing\" style={{fontSize:'12px'}}></i>新增</div>,\n\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\tthis.store.status = 'add';\n\t\t\t\t\t\t\t\t\tthis.handleVisible();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttype: 'primary',\n\t\t\t\t\t\t\t\tclassName:'add-btn'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t// {\n\t\t\t\t\t\t\t// \tname: '删除',\n\t\t\t\t\t\t\t// \tonClick: () => this.handleDelete({type:'batch'})\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t]\n\t\t\t\t\t}}\n\t\t\t\t\tmodal={{\n\t\t\t\t\t\tvisible: this.state.visible,\n\t\t\t\t\t\ttitle: status === 'add' ? '新增' : '编辑',\n\t\t\t\t\t\tonCancel: this.handleVisible,\n\t\t\t\t\t\tonOk: this.handleSubmit,\n\t\t\t\t\t\tisForm: true,\n\t\t\t\t\t\tformColumns:setSchemaFormColumns({\n              status,currentMain:currentMainSchame,maintainType:2,\n            }),\n\t\t\t\t\t\twidth:700,\n            otherContent:<div>\n              <Table\n                scroll={{ y: 300 }}\n                rowKey='id'\n                columns={setSchemaModalColumns({\n\t\t\t\t\t\t\t\t\thandleDetail:this.handleDetail,\n\t\t\t\t\t\t\t\t\tcontentLabel:'巡检内容',contentTypeLabel:'巡检类型'\n\t\t\t\t\t\t\t\t})}\n                dataSource={serverList}\n                rowSelection={{\n                  selectedRowKeys: this.state.modalSelectedRowKeys,\n\t\t\t            onChange: this.onModalItemSelect,\n\t\t\t\t\t\t\t\t\tselection:{\n\t\t\t\t\t\t\t\t\t\tkey:'id',\n\t\t\t\t\t\t\t\t\t\ttext:'name'\n\t\t\t\t\t\t\t\t\t}\n                }}\n                pagination={false}\n                size='small'\n              />\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.state.tags.length > 0 && [\n\t\t\t\t\t\t\t\t\t<div style={{fontSize:'14px',fontWeight:'600',padding:'10px'}}>\n\t\t\t\t\t\t\t\t\t\t<Icon style={{marginRight:'5px',color:'#6236FF'}} type=\"info-circle\" />显示顺序</div>,\n\t\t\t\t\t\t\t\t\t<div className='Simple-2'>\n\t\t\t\t\t\t\t\t\t\t<DraggableArea\n\t\t\t\t\t\t\t\t\t\t\ttags={this.state.tags}\n\t\t\t\t\t\t\t\t\t\t\trender={({ tag, index }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='tag' key={index}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={require('../../../../assets/delete.png')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt='delete'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName='delete'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.handleClickDelete(tag)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{tag.content}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\tonChange={this.changeTag}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n            </div>\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\t/* 点击查看库中每项内容的详情 */\n\thandleDetail = (id) =>{\n\t\tthis.store.status = 'query'\n\t\tthis.store.getInfo({ id },'server').then(()=>{\n\t\t\tthis.store.editVisible = !this.store.editVisible;\n\t\t});\n\t}\n\thandleStatus = (record)=>{\n\t\tthis.store.save({\n\t\t\tid:record.id,\n\t\t\tplanStatus:record.planStatus === 1 ? 0 : 1 ,\n\t\t\tmaintainType:2,\n\t\t},'schema')\n\t}\n\t/* modal - operate */\n\thandleVisible = () => {\n\t\t/* 每次打开弹窗 获取所有的巡检列表 */\n\t\tif(!this.state.visible){\n\t\t\tthis.store.getMaintainServer({}).then(()=>{\n\t\t\t\tif(this.store.status == 'edit'){\n\t\t\t\t\tthis.state.tags = []\n\t\t\t\t\tthis.store.currentMainSchame.contentIds && this.store.currentMainSchame.contentIds.split(',').map(item=>{\n\t\t\t\t\t\tlet tag = toJS(this.store.serverList).filter(tag => tag.id === parseInt(item))[0]\n\t\t\t\t\t\tthis.state.tags.push(tag)\n\t\t\t\t\t})\n\t\t\t\t}else{\n\t\t\t\t\tthis.state.tags = []\n\t\t\t\t\tthis.state.modalSelectedRowKeys = []\n\t\t\t\t}\n\t\t\t\tthis.setState({})\n\t\t\t});\n\t\t}\n\t\tif(this.state.visible){\n\t\t\tthis.state = {\n\t\t\t\t...this.state,\n\t\t\t\tselectedRowKeys: [],\n\t\t\t\tmodalSelectedRowKeys :[], //弹窗内部的选项\n\t\t\t\ttags:[]\n\t\t\t};\n\t\t}\n\t\tthis.setState({\n\t\t\tvisible:!this.state.visible\n\t\t})\n\t}\n  /* 弹窗内表格的操作 */\n  onModalItemSelect = selectedRowKeys =>{\n\t\tthis.state.tags = []\n\t\tselectedRowKeys.map(item=>{\n\t\t\tlet tag = toJS(this.store.serverList).filter(tag => tag.id === item)[0]\n\t\t\tthis.state.tags.push(tag)\n\t\t})\n    this.setState({\n      modalSelectedRowKeys: selectedRowKeys\n    })\n\t}\n\tchangeTag = tags =>{\n\t\tthis.setState({tags})\n\t}\n\thandleClickDelete = (tag) => {\n\t\tconst tags = this.state.tags.filter(t => tag.id !== t.id);\n\t\tlet selectedRowKeys = []\n\t\ttags.map(item=>{\n\t\t\tselectedRowKeys.push(item.id)\n\t\t})\n\t\tthis.setState({ tags,modalSelectedRowKeys: selectedRowKeys });\n\t}\n  /* 弹窗提交操作 */\n\thandleSubmit = values => {\n\t\tconst { deviceType,status,currentMainSchame,maintainType } = this.store;\n\t\tconst { tags } = this.state;\n\t\tthis.state.modalSelectedRowKeys = []\n\t\ttags.map(item=>{\n\t\t\tthis.state.modalSelectedRowKeys.push(item.id)\n\t\t})\n    let params = {\n      deviceType,\n      contentIds:this.state.modalSelectedRowKeys.join(','),\n      maintainType,\n      ...values\n    }\n    if(status !== 'add'){\n      params.id = currentMainSchame.id\n    }\n\t\tthis.store.save(params,'schema');\n    this.handleVisible();\n\t};\n\t/* 编辑弹窗 */\n\thandleEdit = value => {\n\t\tthis.store.status = 'edit';\n\t\tthis.store.getInfo({ id: value },'schema').then(()=>{\n      let data = this.store.currentMainSchame.contentIds.split(','),newDs = [];\n      data.map(item=>{\n        newDs.push(parseFloat(item))\n      })\n      this.setState({\n        modalSelectedRowKeys:newDs\n      },()=>{\n\t\t\t\tthis.handleVisible();\n\t\t\t})\n    })\n  };\n  /* 删除 巡检方案 */\n\thandleDelete = ({type, value}) => {\n\t\tif (type === 'batch') {\n\t\t\tif (this.state.selectedRowKeys.length < 1) {\n\t\t\t\tModal.warn({\n\t\t\t\t\ttitle: '提示',\n\t\t\t\t\tcontent: '请选择需要删除的内容'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tModal.confirm({\n\t\t\t\t\ttitle: '提示',\n\t\t\t\t\tcontent:\n\t\t\t\t\t\t'确定删除选中的' +\n\t\t\t\t\t\tthis.state.selectedRowKeys.length +\n\t\t\t\t\t\t'条巡检内容？',\n\t\t\t\t\tokText: '确定',\n\t\t\t\t\tcancelText: '取消',\n\t\t\t\t\tonOk: () => {\n\t\t\t\t\t\tthis.store.delete(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tids: this.state.selectedRowKeys\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'schema'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tModal.confirm({\n\t\t\t\ttitle: '提示',\n\t\t\t\tcontent: '确定删除当前巡检内容？',\n\t\t\t\tokText: '确定',\n\t\t\t\tcancelText: '取消',\n\t\t\t\tonOk: () => {\n\t\t\t\t\tthis.store.delete(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: value\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'schema'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\thandleSelect = selectedRowKeys => {\n\t\tthis.setState({ selectedRowKeys });\n\t};\n\t/* check - tag */\n\thandleCheckTag = tag => {\n\t\tthis.store.deviceType = tag.id;\n\t\tthis.store.getMaintainSchema({\n\t\t\ttypeId: tag.id\n\t\t});\n\t};\n\tcomponentDidMount() {\n\t\tthis.store.getMaintainSchema({\n\t\t\ttypeId: this.store.deviceType\n\t\t});\n  }\n}\nexport default SchemaMenu;\n"]},"metadata":{},"sourceType":"module"}