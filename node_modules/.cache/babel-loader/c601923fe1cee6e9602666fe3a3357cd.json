{"ast":null,"code":"import \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/divider/style\";\nimport _Divider from \"antd/lib/divider\";\nimport \"antd/lib/badge/style\";\nimport _Badge from \"antd/lib/badge\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _classCallCheck from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"F:\\\\documents\\\\bl-device-manage\\\\src\\\\layouts\\\\SystemManager\\\\UserManager\\\\UserTable.js\";\n\nimport React, { Component } from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { Form } from '@ant-design/compatible';\nimport '@ant-design/compatible/assets/index.css';\nimport TableLayout from 'Components/TableLayout';\nimport GlobalModal from 'Components/GlobalModal';\nimport { toJS } from 'mobx';\nvar UserTable = (_dec = inject('SystemStore'), _dec(_class = observer(_class = (_temp =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(UserTable, _Component);\n\n  function UserTable(props) {\n    var _this;\n\n    _classCallCheck(this, UserTable);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(UserTable).call(this, props));\n\n    _this.pageChange = function (e) {\n      _this.props.SystemStore.PageInfo = e;\n      _this.props.SystemStore.PageInfo.pageIndex = e.current;\n      var _this$props$SystemSto = _this.props.SystemStore,\n          getData = _this$props$SystemSto.getData,\n          PageInfo = _this$props$SystemSto.PageInfo,\n          deptId = _this$props$SystemSto.deptId,\n          name = _this$props$SystemSto.name,\n          columnsType = _this$props$SystemSto.columnsType;\n      getData(3, {\n        pageIndex: PageInfo.pageIndex,\n        pageSize: PageInfo.pageSize,\n        name: name,\n        deptId: deptId,\n        isSelf: columnsType\n      });\n    };\n\n    _this.handleSubmit = function (e) {\n      e.preventDefault();\n      var _this$props$SystemSto2 = _this.props.SystemStore,\n          getData = _this$props$SystemSto2.getData,\n          resetPassword = _this$props$SystemSto2.resetPassword,\n          formData = _this$props$SystemSto2.formData,\n          PageInfo = _this$props$SystemSto2.PageInfo,\n          name = _this$props$SystemSto2.name,\n          deptId = _this$props$SystemSto2.deptId,\n          columnsType = _this$props$SystemSto2.columnsType;\n\n      _this.props.form.validateFields(function (err, values) {\n        console.log(values);\n\n        if (!err) {\n          var obj = {}; // obj[\"userDO.userId\"] = formData.id\n          // obj.pwdNew = values.password\n\n          resetPassword({\n            pwdNew: values.password,\n            userDO: {\n              id: formData.id\n            }\n          }).then(function (res) {\n            console.log(res);\n\n            if (!res.code) {\n              _message.success('重置成功');\n            } else {\n              _message.error('网络错误，请稍后重试');\n            }\n\n            _this.setState({\n              visible: false\n            });\n\n            getData(3, {\n              pageIndex: PageInfo.pageIndex,\n              pageSize: PageInfo.pageSize,\n              name: name,\n              deptId: deptId,\n              isSelf: columnsType\n            });\n          });\n        }\n      });\n    };\n\n    _this.resetPassword = function (record) {\n      _this.props.SystemStore.formData = record;\n\n      _this.setState({\n        visible: true\n      });\n    };\n\n    _this.editUser = function (record) {\n      var obj = record;\n\n      _this.props.SystemStore.getUserRole({\n        id: record.id\n      }).then(function (res) {\n        obj.roleIds = res;\n\n        _this.props.SystemStore.modalChange(1, obj);\n      });\n    };\n\n    _this.delete = function (record) {\n      var _this$props$SystemSto3 = _this.props.SystemStore,\n          deleteUser = _this$props$SystemSto3.deleteUser,\n          getData = _this$props$SystemSto3.getData,\n          PageInfo = _this$props$SystemSto3.PageInfo,\n          deptId = _this$props$SystemSto3.deptId,\n          name = _this$props$SystemSto3.name,\n          columnsType = _this$props$SystemSto3.columnsType;\n\n      _Modal.confirm({\n        title: '提示',\n        content: '是否确认删除该条数据？',\n        okText: '确认',\n        cancelText: '取消',\n        onOk: function onOk() {\n          deleteUser(1, {\n            id: record.id\n          }).then(function (res) {\n            _message.success('删除成功');\n\n            getData(3, {\n              pageIndex: PageInfo.pageIndex,\n              pageSize: PageInfo.pageSize,\n              name: name,\n              deptId: deptId,\n              isSelf: columnsType\n            });\n          });\n        }\n      });\n    };\n\n    _this.state = {\n      visible: false\n    };\n    return _this;\n  }\n\n  _createClass(UserTable, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _toJS = toJS(this.props.SystemStore),\n          tableData = _toJS.tableData,\n          PageInfo = _toJS.PageInfo,\n          isLoading = _toJS.isLoading; //定义表头\n\n\n      var columns = [{\n        title: '姓名',\n        dataIndex: 'name',\n        key: 'name'\n      }, {\n        title: '用户名/工号',\n        dataIndex: 'username',\n        key: 'username'\n      }, {\n        title: '手机',\n        dataIndex: 'mobile',\n        key: 'mobile',\n        render: function render(text) {\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 39\n            },\n            __self: this\n          }, text ? text : '-');\n        }\n      }, {\n        title: '邮箱',\n        dataIndex: 'email',\n        key: 'email',\n        render: function render(text) {\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 47\n            },\n            __self: this\n          }, text ? text : '-');\n        }\n      }, {\n        title: '状态',\n        dataIndex: 'status',\n        key: 'status',\n        render: function render(text, record) {\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 55\n            },\n            __self: this\n          }, text ? React.createElement(_Badge, {\n            status: \"success\",\n            text: \"\\u6B63\\u5E38\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 56\n            },\n            __self: this\n          }) : React.createElement(_Badge, {\n            status: \"error\",\n            text: \"\\u7981\\u7528\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 56\n            },\n            __self: this\n          }));\n        }\n      }, {\n        title: '操作',\n        align: 'right',\n        render: function render(text, record) {\n          return React.createElement(\"span\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 64\n            },\n            __self: this\n          }, React.createElement(\"a\", {\n            onClick: function onClick(e) {\n              return _this2.editUser(record);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 65\n            },\n            __self: this\n          }, \"\\u7F16\\u8F91\"), React.createElement(_Divider, {\n            type: \"vertical\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 66\n            },\n            __self: this\n          }), React.createElement(\"a\", {\n            onClick: function onClick(e) {\n              return _this2.delete(record);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 67\n            },\n            __self: this\n          }, \"\\u5220\\u9664\"), React.createElement(_Divider, {\n            type: \"vertical\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 68\n            },\n            __self: this\n          }), React.createElement(\"a\", {\n            onClick: function onClick(e) {\n              return _this2.resetPassword(record);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 69\n            },\n            __self: this\n          }, \"\\u91CD\\u7F6E\\u5BC6\\u7801\"));\n        }\n      }]; // 选中表格选项\n\n      var rowSelection = {\n        onSelect: function onSelect(record, selected, selectedRows) {\n          console.log(record, selected, selectedRows);\n          _this2.props.SystemStore.selectedRows = selectedRows;\n        },\n        onSelectAll: function onSelectAll(selected, selectedRows, changeRows) {\n          _this2.props.SystemStore.selectedRows = selectedRows;\n        }\n      };\n      var getFieldDecorator = this.props.form.getFieldDecorator;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, React.createElement(TableLayout, {\n        rowKey: \"id\",\n        rowSelection: rowSelection,\n        onChange: this.pageChange,\n        loading: isLoading,\n        columns: columns,\n        dataSource: tableData,\n        pagination: PageInfo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }), this.state.visible && React.createElement(GlobalModal, {\n        title: \"\\u91CD\\u7F6E\\u5BC6\\u7801\",\n        visible: this.state.visible,\n        onOk: this.handleSubmit,\n        width: '50%',\n        onCancel: function onCancel(e) {\n          return _this2.setState({\n            visible: false\n          });\n        },\n        children: React.createElement(Form, {\n          onSubmit: this.handleSubmit,\n          layout: \"horizontal\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94\n          },\n          __self: this\n        }, React.createElement(Form.Item, {\n          label: \"\\u5BC6\\u7801\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95\n          },\n          __self: this\n        }, getFieldDecorator('password', {\n          rules: [{\n            required: true,\n            message: '请输入密码'\n          }],\n          initialValue: \"\"\n        })(React.createElement(_Input, {\n          placeholder: \"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",\n          type: \"password\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        })))),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }));\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props$SystemSto4 = this.props.SystemStore,\n          getData = _this$props$SystemSto4.getData,\n          PageInfo = _this$props$SystemSto4.PageInfo,\n          deptId = _this$props$SystemSto4.deptId,\n          name = _this$props$SystemSto4.name;\n      getData(3, {\n        pageIndex: PageInfo.pageIndex,\n        pageSize: PageInfo.pageSize,\n        name: name,\n        deptId: deptId\n      });\n    }\n  }]);\n\n  return UserTable;\n}(Component), _temp)) || _class) || _class);\nvar UserTableForm = Form.create({\n  name: 'user'\n})(UserTable);\nexport default UserTableForm;","map":{"version":3,"sources":["F:\\documents\\bl-device-manage\\src\\layouts\\SystemManager\\UserManager\\UserTable.js"],"names":["React","Component","inject","observer","Form","TableLayout","GlobalModal","toJS","UserTable","props","pageChange","e","SystemStore","PageInfo","pageIndex","current","getData","deptId","name","columnsType","pageSize","isSelf","handleSubmit","preventDefault","resetPassword","formData","form","validateFields","err","values","console","log","obj","pwdNew","password","userDO","id","then","res","code","success","error","setState","visible","record","editUser","getUserRole","roleIds","modalChange","delete","deleteUser","confirm","title","content","okText","cancelText","onOk","state","tableData","isLoading","columns","dataIndex","key","render","text","align","rowSelection","onSelect","selected","selectedRows","onSelectAll","changeRows","getFieldDecorator","rules","required","message","initialValue","UserTableForm","create"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { inject, observer } from 'mobx-react';\r\nimport { Form } from '@ant-design/compatible';\r\nimport '@ant-design/compatible/assets/index.css';\r\nimport { Divider, Modal, message, Badge, Input } from 'antd';\r\nimport TableLayout from 'Components/TableLayout'\r\nimport GlobalModal from 'Components/GlobalModal';\r\nimport { toJS } from 'mobx';\r\n\r\n\r\n@inject('SystemStore')\r\n@observer\r\nclass UserTable extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            visible: false\r\n        }\r\n    }\r\n    render() {\r\n        const { tableData, PageInfo, isLoading, } = toJS(this.props.SystemStore)\r\n        //定义表头\r\n        const columns = [\r\n            {\r\n                title: '姓名',\r\n                dataIndex: 'name',\r\n                key: 'name',\r\n            },\r\n            {\r\n                title: '用户名/工号',\r\n                dataIndex: 'username',\r\n                key: 'username',\r\n            },\r\n            {\r\n                title: '手机',\r\n                dataIndex: 'mobile',\r\n                key: 'mobile',\r\n                render: (text) => (\r\n                    <div>{text ? text : '-'}</div>\r\n                )\r\n            },\r\n            {\r\n                title: '邮箱',\r\n                dataIndex: 'email',\r\n                key: 'email',\r\n                render: (text) => (\r\n                    <div>{text ? text : '-'}</div>\r\n                )\r\n            },\r\n            {\r\n                title: '状态',\r\n                dataIndex: 'status',\r\n                key: 'status',\r\n                render: (text, record) => (\r\n                    <div>\r\n                        {text ? <Badge status='success' text=\"正常\" /> : <Badge status='error' text=\"禁用\" />}\r\n                    </div>\r\n                )\r\n            },\r\n            {\r\n                title: '操作',\r\n                align: 'right',\r\n                render: (text, record) => (\r\n                    <span>\r\n                        <a onClick={e => this.editUser(record)}>编辑</a>\r\n                        <Divider type=\"vertical\" />\r\n                        <a onClick={e => this.delete(record)}>删除</a>\r\n                        <Divider type=\"vertical\" />\r\n                        <a onClick={e => this.resetPassword(record)}>重置密码</a>\r\n                    </span>\r\n                )\r\n            }\r\n        ];\r\n        // 选中表格选项\r\n        const rowSelection = {\r\n            onSelect: (record, selected, selectedRows) => {\r\n                console.log(record, selected, selectedRows);\r\n                this.props.SystemStore.selectedRows = selectedRows\r\n            },\r\n            onSelectAll: (selected, selectedRows, changeRows) => {\r\n                this.props.SystemStore.selectedRows = selectedRows\r\n            }\r\n        };\r\n        const { getFieldDecorator } = this.props.form;\r\n        return <div >\r\n            <TableLayout rowKey=\"id\" rowSelection={rowSelection} onChange={this.pageChange} loading={isLoading} columns={columns} dataSource={tableData} pagination={PageInfo} />\r\n            {this.state.visible && <GlobalModal\r\n                title='重置密码'\r\n                visible={this.state.visible}\r\n                onOk={this.handleSubmit}\r\n                width={'50%'}\r\n                onCancel={e => this.setState({ visible: false })}\r\n                children={\r\n                    <Form onSubmit={this.handleSubmit} layout='horizontal'>\r\n                        <Form.Item label=\"密码\">\r\n                            {getFieldDecorator('password', {\r\n                                rules: [{ required: true, message: '请输入密码' }],\r\n                                initialValue: \"\"\r\n                            })(\r\n                                <Input placeholder=\"请输入密码\" type='password' />\r\n                            )}\r\n                        </Form.Item>\r\n                    </Form>\r\n                } />}\r\n        </div>;\r\n    }\r\n    pageChange = (e) => {\r\n        this.props.SystemStore.PageInfo = e\r\n        this.props.SystemStore.PageInfo.pageIndex = e.current\r\n        const { getData, PageInfo, deptId, name, columnsType } = this.props.SystemStore\r\n        getData(3, { pageIndex: PageInfo.pageIndex, pageSize: PageInfo.pageSize, name, deptId, isSelf: columnsType })\r\n    }\r\n    //提交表单\r\n    handleSubmit = e => {\r\n        e.preventDefault();\r\n        const { getData, resetPassword, formData, PageInfo, name, deptId, columnsType } = this.props.SystemStore\r\n        this.props.form.validateFields((err, values) => {\r\n            console.log(values)\r\n            if (!err) {\r\n                let obj = {}\r\n                // obj[\"userDO.userId\"] = formData.id\r\n                // obj.pwdNew = values.password\r\n                resetPassword({ pwdNew: values.password, userDO: { id: formData.id } }).then(res => {\r\n                    console.log(res)\r\n                    if (!res.code) {\r\n                        message.success('重置成功')\r\n                    } else {\r\n                        message.error('网络错误，请稍后重试')\r\n                    }\r\n                    this.setState({\r\n                        visible: false\r\n                    })\r\n                    getData(3, { pageIndex: PageInfo.pageIndex, pageSize: PageInfo.pageSize, name, deptId, isSelf: columnsType })\r\n                })\r\n            }\r\n        });\r\n    };\r\n    resetPassword = (record) => {\r\n        this.props.SystemStore.formData = record\r\n        this.setState({\r\n            visible: true\r\n        })\r\n    }\r\n    editUser = (record) => {\r\n        let obj = record\r\n        this.props.SystemStore.getUserRole({ id: record.id }).then(res => {\r\n            obj.roleIds = res\r\n            this.props.SystemStore.modalChange(1, obj)\r\n        })\r\n    }\r\n    delete = (record, ) => {\r\n        const { deleteUser, getData, PageInfo, deptId, name, columnsType } = this.props.SystemStore\r\n        Modal.confirm({\r\n            title: '提示',\r\n            content: '是否确认删除该条数据？',\r\n            okText: '确认',\r\n            cancelText: '取消',\r\n            onOk: () => {\r\n                deleteUser(1, { id: record.id }).then(res => {\r\n                    message.success('删除成功')\r\n                    getData(3, { pageIndex: PageInfo.pageIndex, pageSize: PageInfo.pageSize, name, deptId, isSelf: columnsType })\r\n                })\r\n            },\r\n        });\r\n\r\n    }\r\n    componentDidMount() {\r\n        const { getData, PageInfo, deptId, name } = this.props.SystemStore\r\n        getData(3, { pageIndex: PageInfo.pageIndex, pageSize: PageInfo.pageSize, name, deptId })\r\n    }\r\n}\r\nconst UserTableForm = Form.create({ name: 'user' })(UserTable);\r\nexport default UserTableForm;"]},"metadata":{},"sourceType":"module"}