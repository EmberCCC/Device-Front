{"ast":null,"code":"import \"antd/lib/spin/style\";\nimport _Spin from \"antd/lib/spin\";\nimport \"antd/lib/empty/style\";\nimport _Empty from \"antd/lib/empty\";\nimport \"antd/lib/checkbox/style\";\nimport _Checkbox from \"antd/lib/checkbox\";\nimport _objectSpread from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"F:\\\\documents\\\\bl-device-manage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"F:\\\\documents\\\\bl-device-manage\\\\src\\\\layouts\\\\BasicManage\\\\TitleConfigPage\\\\index.js\";\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { toJS } from 'mobx';\nimport { Tabs, Button } from 'components/BLComps';\nimport { PlusOutlined } from '@ant-design/icons';\nimport Category from 'components/Category';\nimport { DraggableArea } from 'react-draggable-tags';\nimport './index.less';\nimport GlobalFooter from 'components/GlobalFooter';\nvar TitleConfigPage = (_dec = inject('TitleConfigStore'), _dec(_class = observer(_class = (_temp =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(TitleConfigPage, _React$Component);\n\n  function TitleConfigPage(props) {\n    var _this;\n\n    _classCallCheck(this, TitleConfigPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TitleConfigPage).call(this, props));\n\n    _this.handleSubmit = function () {\n      var params = [];\n\n      _this.state.tags.map(function (tag, index) {\n        params.push({\n          id: tag.id,\n          checked: tag.checked,\n          sort: index + 1\n        });\n      });\n\n      _this.store.saveTitle({\n        titleDOList: params\n      }, {\n        menuId: _this.state.secTabKey == 'work' ? 2 : _this.state.secTabKey\n      });\n    };\n\n    _this.handleTitle = function (checkedList) {\n      _this.state.tags.map(function (tag) {\n        Object.assign(tag, {\n          checked: false\n        });\n        checkedList.map(function (item) {\n          if (item === tag.titleKey) {\n            Object.assign(tag, {\n              checked: true\n            });\n          }\n        });\n      });\n\n      _this.setState({\n        checkedList: checkedList,\n        indeterminate: !!checkedList.length && checkedList.length < _this.state.tags.length,\n        checkAll: checkedList.length === _this.state.tags.length\n      });\n    };\n\n    _this.onCheckAllChange = function (e) {\n      var checkedList = [];\n\n      if (e.target.checked) {\n        _this.state.tags.map(function (item) {\n          Object.assign(item, {\n            checked: true\n          });\n          checkedList.push(item.titleKey);\n        });\n      } else {\n        _this.state.tags.map(function (item) {\n          Object.assign(item, {\n            checked: false\n          });\n        });\n      }\n\n      _this.setState({\n        checkedList: checkedList,\n        indeterminate: false,\n        checkAll: e.target.checked\n      });\n    };\n\n    _this.handleClickDelete = function (tag) {\n      var tags = _this.state.tags.filter(function (t) {\n        return tag.id !== t.id;\n      });\n\n      _this.state.checkedList = _this.state.checkedList.filter(function (t) {\n        return t !== tag.titleKey;\n      });\n\n      _this.setState({\n        tags: tags\n      });\n    };\n\n    _this.changeTag = function (tags) {\n      _this.setState({\n        tags: tags\n      });\n    };\n\n    _this.handleCates = function (tag) {\n      _this.getTitle({\n        menuId: tag.key\n      });\n    };\n\n    _this.handleFirst = function (key) {\n      _this.setState({\n        secTabKey: key\n      });\n\n      if (key === 'work') key = 2;\n\n      _this.getTitle({\n        menuId: parseInt(key)\n      });\n    };\n\n    _this.getTitle = function (params) {\n      _this.store.getTitle(params).then(function () {\n        _this.state.tags = toJS(_this.store.titleList);\n        _this.state.tagsList = [];\n\n        _this.state.tags.map(function (item) {\n          if (item.checked) {\n            _this.state.checkedList.push(item.titleKey);\n          }\n\n          _this.state.tagsList.push(_objectSpread({}, item, {\n            label: item.titleValue,\n            value: item.titleKey\n          }));\n        });\n\n        if (_this.state.checkedList.length === _this.state.tags.length) {\n          _this.state.checkAll = true;\n        }\n\n        _this.setState({});\n      });\n    };\n\n    _this.store = _this.props.TitleConfigStore;\n    _this.state = {\n      secTabKey: '1',\n      tabs: [{\n        tab: '设备管理',\n        key: 1\n      }],\n      content: [{\n        tab: '待办任务',\n        key: 2\n      }, {\n        tab: '工单明细',\n        key: 3\n      }, {\n        tab: '工单报告',\n        key: 4\n      }],\n      tags: toJS(_this.store.titleList),\n      checkedList: [],\n      tagsList: [],\n      checkAll: false,\n      indeterminate: false\n    };\n    return _this;\n  }\n\n  _createClass(TitleConfigPage, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      console.log(this.state.tags, toJS(this.store.titleList));\n      var operations = React.createElement(Button, {\n        type: \"link\",\n        disabled: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 39\n        },\n        __self: this\n      }, React.createElement(PlusOutlined, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 39\n        },\n        __self: this\n      }), \"\\u65B0\\u589E\");\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }, React.createElement(_Spin, {\n        spinning: this.store.isLoading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 41\n        },\n        __self: this\n      }, React.createElement(Tabs, {\n        type: \"card\",\n        tabBarStyle: {\n          height: 30\n        },\n        dataSource: this.state.tabs,\n        tabBarExtraContent: operations,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 42\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"tab-content-bg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50\n        },\n        __self: this\n      }, React.createElement(Tabs, {\n        type: \"wrapper\",\n        defaultActiveKey: \"1\",\n        dataSource: [{\n          tab: '设备台账',\n          key: 1\n        }, {\n          tab: '运维工单',\n          key: 'work'\n        }],\n        onChange: this.handleFirst,\n        style: {\n          marginBottom: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      }), this.state.secTabKey === 'work' && React.createElement(Category, {\n        keyName: \"tab\",\n        title: \"\\u9009\\u9879\",\n        defaultActiveKey: this.state.content[0],\n        content: this.state.content,\n        onClick: this.handleCates,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"title_tab_body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, \"\\u8BF7\\u9009\\u62E9\\u9700\\u8981\\u5C55\\u793A\\u7684\\u5217\\u8868\\u8868\\u5934\\u9879\\uFF1A\"), React.createElement(\"div\", {\n        style: {\n          borderBottom: '1px solid #E9E9E9',\n          marginBottom: 5\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, React.createElement(_Checkbox, {\n        indeterminate: this.state.indeterminate,\n        onChange: this.onCheckAllChange,\n        checked: this.state.checkAll,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, \"\\u5168\\u90E8\")), this.state.tagsList.length > 0 && React.createElement(_Checkbox.Group, {\n        options: this.state.tagsList,\n        value: this.state.checkedList,\n        onChange: this.handleTitle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, \"\\u663E\\u793A\\u987A\\u5E8F\\uFF08\\u53EF\\u62D6\\u62FD\\u5B9E\\u73B0title\\u7684\\u6392\\u5E8F\\uFF09\\uFF1A\"), this.state.checkedList.length > 0 ? React.createElement(\"div\", {\n        className: \"Simple\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, React.createElement(DraggableArea, {\n        tags: this.state.tags,\n        render: function render(_ref) {\n          var tag = _ref.tag,\n              index = _ref.index;\n          return tag.checked && React.createElement(\"div\", {\n            className: \"tag\",\n            key: tag.id,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 98\n            },\n            __self: this\n          }, React.createElement(\"img\", {\n            src: require('assets/delete.png'),\n            alt: \"delete\",\n            className: \"delete\",\n            onClick: function onClick() {\n              return _this2.handleClickDelete(tag);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 99\n            },\n            __self: this\n          }), tag.titleValue);\n        },\n        onChange: this.changeTag,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      })) : React.createElement(\"div\", {\n        style: {\n          border: '1px dashed #9d9d9d'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, React.createElement(_Empty, {\n        image: _Empty.PRESENTED_IMAGE_SIMPLE,\n        description: \"\\u6682\\u65E0\\u9009\\u9879\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"tab_footer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(Button, {\n        type: \"primary\",\n        loading: this.store.isLoading,\n        onClick: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, \"\\u63D0\\u4EA4\"))))));\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getTitle({\n        menuId: 1\n      });\n    }\n  }]);\n\n  return TitleConfigPage;\n}(React.Component), _temp)) || _class) || _class);\nexport default TitleConfigPage;","map":{"version":3,"sources":["F:\\documents\\bl-device-manage\\src\\layouts\\BasicManage\\TitleConfigPage\\index.js"],"names":["React","inject","observer","toJS","Tabs","Button","PlusOutlined","Category","DraggableArea","GlobalFooter","TitleConfigPage","props","handleSubmit","params","state","tags","map","tag","index","push","id","checked","sort","store","saveTitle","titleDOList","menuId","secTabKey","handleTitle","checkedList","Object","assign","item","titleKey","setState","indeterminate","length","checkAll","onCheckAllChange","e","target","handleClickDelete","filter","t","changeTag","handleCates","getTitle","key","handleFirst","parseInt","then","titleList","tagsList","label","titleValue","value","TitleConfigStore","tabs","tab","content","console","log","operations","isLoading","height","marginBottom","borderBottom","require","border","PRESENTED_IMAGE_SIMPLE","Component"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { inject,observer } from 'mobx-react'\r\nimport { toJS } from 'mobx'\r\nimport { Tabs,Button } from 'components/BLComps'\r\nimport { PlusOutlined } from '@ant-design/icons';\r\nimport { Checkbox, Spin, Empty } from 'antd';\r\nimport Category from 'components/Category';\r\nimport { DraggableArea } from 'react-draggable-tags';\r\nimport './index.less'\r\nimport GlobalFooter from 'components/GlobalFooter';\r\n\r\n\r\n@inject('TitleConfigStore')\r\n@observer\r\nclass TitleConfigPage extends React.Component{\r\n  constructor(props){\r\n    super(props)\r\n    this.store = this.props.TitleConfigStore\r\n    this.state = {\r\n      secTabKey:'1',\r\n      tabs:[\r\n        { tab:'设备管理', key: 1 },\r\n      ],\r\n      content : [ \r\n        { tab:'待办任务', key: 2 },\r\n        { tab:'工单明细', key: 3 },\r\n        { tab:'工单报告', key: 4 },\r\n      ],\r\n      tags : toJS(this.store.titleList),\r\n      checkedList:[],\r\n      tagsList:[],\r\n      checkAll:false,\r\n      indeterminate:false,\r\n      \r\n    }\r\n  }\r\n  render(){\r\n    console.log(this.state.tags,toJS(this.store.titleList))\r\n    const operations = <Button type='link' disabled><PlusOutlined />新增</Button>\r\n    return <div>\r\n      <Spin spinning={this.store.isLoading}>\r\n        <Tabs\r\n          type='card'\r\n          tabBarStyle = {{ height:30 }}\r\n          dataSource={\r\n            this.state.tabs\r\n          }\r\n          tabBarExtraContent={operations}\r\n        />\r\n        <div className='tab-content-bg'>\r\n          <Tabs\r\n            type='wrapper'\r\n            defaultActiveKey = '1'\r\n            dataSource = {\r\n              [\r\n                { tab:'设备台账',key:1 },\r\n                { tab:'运维工单',key:'work' },\r\n              ]\r\n            }\r\n            onChange={this.handleFirst}\r\n            style={{marginBottom:10}}\r\n          />\r\n          {\r\n            this.state.secTabKey === 'work' && <Category\r\n              keyName='tab'\r\n              title='选项'\r\n              defaultActiveKey = {this.state.content[0]}\r\n              content = {this.state.content}\r\n              onClick={this.handleCates}\r\n            />\r\n          }\r\n          <div className='title_tab_body'>  \r\n            <div>\r\n              <h4>请选择需要展示的列表表头项：</h4>\r\n              <div style={{ borderBottom: '1px solid #E9E9E9',marginBottom:5 }}>\r\n                <Checkbox\r\n                  indeterminate={this.state.indeterminate}\r\n                  onChange={this.onCheckAllChange}\r\n                  checked={this.state.checkAll}\r\n                >\r\n                  全部\r\n                </Checkbox>\r\n              </div>\r\n              {            \r\n                this.state.tagsList.length > 0 && <Checkbox.Group\r\n                  options={this.state.tagsList}\r\n                  value={this.state.checkedList}\r\n                  onChange={this.handleTitle}\r\n                />\r\n              }\r\n            </div>\r\n            <div>\r\n              <h4>显示顺序（可拖拽实现title的排序）：</h4> \r\n              {this.state.checkedList.length > 0 ?<div className='Simple'>\r\n                <DraggableArea\r\n                  tags={this.state.tags}\r\n                  render={({ tag, index }) => (\r\n                    tag.checked && <div className='tag' key={tag.id}>\r\n                      <img\r\n                        src={require('assets/delete.png')}\r\n                        alt='delete'\r\n                        className='delete'\r\n                        onClick={() => this.handleClickDelete(tag)}\r\n                      />\r\n                      {tag.titleValue}\r\n                    </div>\r\n                  )}\r\n                  onChange={this.changeTag}\r\n                /> \r\n              </div> : <div style={{border:'1px dashed #9d9d9d'}}>\r\n                <Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description='暂无选项' />\r\n              </div>}\r\n\r\n            </div>\r\n            <div className='tab_footer'>\r\n              <Button type='primary' loading={this.store.isLoading} onClick={this.handleSubmit}>提交</Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Spin>\r\n    </div>\r\n  }\r\n  handleSubmit = () =>{\r\n    let params = []\r\n    this.state.tags.map((tag,index)=>{\r\n      params.push({id:tag.id,checked:tag.checked,sort:index+1})\r\n    })\r\n    this.store.saveTitle({titleDOList:params},{menuId:this.state.secTabKey == 'work' ? 2 : this.state.secTabKey})\r\n  }\r\n  handleTitle = checkedList => {\r\n    this.state.tags.map(tag =>{\r\n      Object.assign(tag,{\r\n        checked : false\r\n      })\r\n      checkedList.map(item=>{\r\n        if(item === tag.titleKey){\r\n          Object.assign(tag,{\r\n            checked : true\r\n          })\r\n        }\r\n      })\r\n    })\r\n    this.setState({\r\n      checkedList,\r\n      indeterminate: !!checkedList.length && checkedList.length < this.state.tags.length,\r\n      checkAll: checkedList.length === this.state.tags.length,\r\n    });\r\n  };\r\n  onCheckAllChange = e => {\r\n    let checkedList = []\r\n    if(e.target.checked){\r\n      this.state.tags.map(item=>{\r\n        Object.assign(item,{\r\n          checked:true\r\n        })\r\n        checkedList.push(item.titleKey)\r\n      })\r\n    }else{\r\n      this.state.tags.map(item=>{\r\n        Object.assign(item,{\r\n          checked:false\r\n        })\r\n      })\r\n    }\r\n    this.setState({\r\n      checkedList,\r\n      indeterminate: false,\r\n      checkAll: e.target.checked,\r\n    });\r\n  }\r\n  handleClickDelete = (tag) => {\r\n    const tags = this.state.tags.filter(t => tag.id !== t.id);\r\n    this.state.checkedList = this.state.checkedList.filter(t => t !== tag.titleKey)\r\n\t\tthis.setState({ tags });\r\n\t}\r\n  changeTag = tags =>{\r\n    this.setState({\r\n      tags\r\n    })\r\n  }\r\n  handleCates = tag =>{\r\n    this.getTitle({menuId:tag.key})\r\n  }\r\n\r\n  handleFirst = key  =>{\r\n    this.setState({secTabKey:key})\r\n    if(key === 'work') key = 2;\r\n    this.getTitle({menuId:parseInt(key)})\r\n  }\r\n  getTitle = params =>{\r\n    this.store.getTitle(params).then(()=>{\r\n      this.state.tags = toJS(this.store.titleList)\r\n      this.state.tagsList = []\r\n      this.state.tags.map(item=>{\r\n        if(item.checked){\r\n          this.state.checkedList.push(item.titleKey)\r\n        }\r\n        this.state.tagsList.push({ ...item,label:item.titleValue,value:item.titleKey })\r\n      })\r\n      if(this.state.checkedList.length === this.state.tags.length){\r\n        this.state.checkAll = true\r\n      }\r\n      this.setState({})\r\n    })\r\n  }\r\n  componentDidMount(){\r\n    this.getTitle({menuId:1})\r\n  }\r\n}\r\n\r\nexport default TitleConfigPage"]},"metadata":{},"sourceType":"module"}