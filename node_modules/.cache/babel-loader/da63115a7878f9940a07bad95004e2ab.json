{"ast":null,"code":"import \"antd/lib/drawer/style\";\nimport _Drawer from \"antd/lib/drawer\";\nimport _slicedToArray from \"F:\\\\documents\\\\bl-device-manage-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"F:\\\\documents\\\\bl-device-manage-test\\\\src\\\\layouts\\\\FormEdit\\\\index.js\";\n\n/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-01 20:45:23\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-05 09:44:05\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormEdit\\index.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\nimport { BulbTwoTone, CloseOutlined } from '@ant-design/icons';\nimport FormRender, { useForm } from 'form-render';\nimport { defaultCommonSetting, defaultGlobalSettings, defaultSettings } from 'constants/field_config';\nimport Generator from 'fr-generator';\nimport { inject, observer } from 'mobx-react';\nimport React, { useEffect, useRef, useState } from 'react';\nimport './index.css';\nimport { Link_item } from './self_item/link_item';\nimport { firstFormName } from 'constants/status_constant';\nvar FormEdit = observer(function (_ref) {\n  var HomeStore = _ref.HomeStore,\n      FormStore = _ref.FormStore;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      visible = _useState2[0],\n      setVisisble = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      exist = _useState4[0],\n      setExist = _useState4[1];\n\n  var ref = useRef();\n  var form = useForm();\n  useEffect(function () {\n    console.log(HomeStore.firstFormId);\n  }, []);\n  useEffect(function () {\n    console.log(exist);\n    var params = {};\n    var pro = {};\n    var subForms = [];\n    params.formId = HomeStore.firstFormId;\n    params.formName = firstFormName[params.formId];\n\n    for (var key in exist) {\n      if (key != 'properties') {\n        pro[key] = exist[key];\n      } else {\n        var field = [];\n        var obj = {};\n        obj['name'] = 'root';\n\n        for (var keyP in exist[key]) {\n          var iObj = {};\n\n          if (keyP.hasOwnProperty('fieldId')) {\n            iObj['fieldId'] = keyP['fieldId'];\n          }\n\n          iObj['name'] = keyP;\n          iObj['typeId'] = keyP.split('_')[0];\n          iObj['detailJson'] = exist[key][keyP];\n          field.push(iObj);\n        }\n\n        obj['fields'] = field;\n        subForms.push(obj);\n      }\n    }\n\n    params['properties'] = pro;\n    params['subForms'] = subForms;\n    console.log(params);\n  }, [exist]);\n\n  var look = function look() {\n    setExist(ref.current.getValue());\n    setVisisble(true);\n  };\n\n  var save = function save() {\n    setExist(ref.current.getValue());\n  };\n\n  var closeDrawer = function closeDrawer() {\n    setVisisble(false);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit_header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit_left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(BulbTwoTone, {\n    className: \"icon_edit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }), /*#__PURE__*/React.createElement(\"a\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, \"\\u67E5\\u770B\\u65B0\\u624B\\u5F15\\u5BFC\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit_right\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"edit_look\",\n    onClick: look,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, \"\\u9884\\u89C8\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"edit_save\",\n    onClick: save,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, \"\\u4FDD\\u5B58\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"fr-generator-playground\",\n    style: {\n      height: '90vh'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(Generator, {\n    ref: ref,\n    settings: defaultSettings,\n    commonSettings: defaultCommonSetting,\n    globalSettings: defaultGlobalSettings,\n    extraButtons: [false, false, false, false],\n    widgets: {\n      link_item: Link_item\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  })), /*#__PURE__*/React.createElement(_Drawer, {\n    placement: \"bottom\",\n    size: \"large\",\n    width: 1200,\n    visible: visible,\n    extra: /*#__PURE__*/React.createElement(CloseOutlined, {\n      onClick: closeDrawer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(FormRender, {\n    schema: exist,\n    form: form,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  })));\n});\nexport default inject(function (stores) {\n  return {\n    HomeStore: stores.HomeStore,\n    FormStore: stores.FormStore\n  };\n})(FormEdit);","map":{"version":3,"names":["BulbTwoTone","CloseOutlined","FormRender","useForm","defaultCommonSetting","defaultGlobalSettings","defaultSettings","Generator","inject","observer","React","useEffect","useRef","useState","Link_item","firstFormName","FormEdit","HomeStore","FormStore","visible","setVisisble","exist","setExist","ref","form","console","log","firstFormId","params","pro","subForms","formId","formName","key","field","obj","keyP","iObj","hasOwnProperty","split","push","look","current","getValue","save","closeDrawer","height","link_item","stores"],"sources":["F:/documents/bl-device-manage-test/src/layouts/FormEdit/index.js"],"sourcesContent":["/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-01 20:45:23\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-05 09:44:05\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormEdit\\index.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\r\nimport { BulbTwoTone, CloseOutlined } from '@ant-design/icons';\r\nimport { Drawer } from 'antd';\r\nimport FormRender, { useForm } from 'form-render';\r\nimport { defaultCommonSetting, defaultGlobalSettings, defaultSettings } from 'constants/field_config';\r\nimport Generator from 'fr-generator';\r\nimport { inject, observer } from 'mobx-react';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\n\r\nimport './index.css'\r\nimport { Link_item } from './self_item/link_item';\r\nimport { firstFormName } from 'constants/status_constant';\r\n\r\n\r\nconst FormEdit = observer(({ HomeStore ,FormStore}) => {\r\n  const [visible,setVisisble] = useState(false)\r\n  const [exist,setExist] = useState({});\r\n  const ref = useRef();\r\n  const form = useForm();\r\n  useEffect(() => {\r\n    console.log(HomeStore.firstFormId);\r\n  }, []);\r\n  useEffect(() => {\r\n    console.log(exist);\r\n    let params = {};\r\n    let pro = {};\r\n    let subForms = [];\r\n    params.formId = HomeStore.firstFormId;\r\n    params.formName = firstFormName[params.formId];\r\n    for (const key in exist) {\r\n      if (key != 'properties') {\r\n        pro[key] = exist[key];\r\n      }else{\r\n        let field = [];\r\n        let obj = {};\r\n        obj['name'] = 'root';\r\n        for (const keyP in exist[key]) {\r\n          let iObj = {};\r\n          if(keyP.hasOwnProperty('fieldId')){\r\n            iObj['fieldId'] = keyP['fieldId'];\r\n          }\r\n          iObj['name'] = keyP\r\n          iObj['typeId'] = keyP.split('_')[0]\r\n          iObj['detailJson'] = exist[key][keyP]\r\n          field.push(iObj);\r\n        }\r\n        obj['fields'] = field\r\n        subForms.push(obj)\r\n      }\r\n    }\r\n    params['properties'] = pro\r\n    params['subForms'] = subForms\r\n    console.log(params);\r\n  },[exist])\r\n  const look = () => {\r\n    setExist(ref.current.getValue())\r\n    setVisisble(true);\r\n  }\r\n  const save = () =>{\r\n    setExist(ref.current.getValue());\r\n    \r\n  }\r\n  const closeDrawer = () => {\r\n    setVisisble(false)\r\n  }\r\n  return (\r\n    <>\r\n      <div className='edit_header'> \r\n        <div className='edit_left'>\r\n          <BulbTwoTone className='icon_edit'/>\r\n          <a>查看新手引导</a>\r\n        </div>\r\n        <div className='edit_right'>\r\n          <button className='edit_look' onClick={look}>预览</button>\r\n          <button className='edit_save' onClick={save}>保存</button>\r\n        </div>\r\n      </div>\r\n      <div className=\"fr-generator-playground\" style={{ height: '90vh' }}>\r\n        <Generator\r\n          ref={ref}\r\n          settings={defaultSettings}\r\n          commonSettings={defaultCommonSetting}\r\n          globalSettings={defaultGlobalSettings}\r\n          extraButtons={[false, false, false,false]}\r\n          widgets={{\r\n            link_item:Link_item\r\n          }}\r\n        />\r\n      </div>\r\n      <Drawer \r\n        placement='bottom'\r\n        size='large'\r\n        width={1200}\r\n        visible={visible}\r\n        extra={\r\n          <CloseOutlined onClick={closeDrawer}/>\r\n        }\r\n      >\r\n        <FormRender schema={exist} form={form}/>\r\n      </Drawer>\r\n    </>\r\n  );\r\n});\r\n\r\nexport default inject((stores) => ({ HomeStore: stores.HomeStore,FormStore:stores.FormStore }))(FormEdit);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}