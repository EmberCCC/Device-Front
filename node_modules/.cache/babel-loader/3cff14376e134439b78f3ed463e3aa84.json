{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/tabs/style\";\nimport _Tabs from \"antd/lib/tabs\";\nimport _defineProperty from \"F:\\\\documents\\\\bl-device-manage-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"F:\\\\documents\\\\bl-device-manage-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"F:\\\\documents\\\\bl-device-manage-test\\\\src\\\\layouts\\\\FormLayout\\\\index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-02 03:21:54\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-19 04:21:10\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormLayout\\index.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\nimport React, { useEffect, useState } from 'react';\nimport FormRender, { useForm } from 'form-render';\nimport { inject, observer } from 'mobx-react';\nimport { toJS } from 'mobx';\nimport { restore } from 'layouts/FormEdit/changeTool';\nimport { getCheckArr } from './formUtil';\nimport { Self_divider } from 'layouts/FormEdit/self_item/self_divider';\nvar FormLayout = observer(function (_ref) {\n  var HomeStore = _ref.HomeStore,\n      FormStore = _ref.FormStore;\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      schema = _useState2[0],\n      setSchema = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      data = _useState4[0],\n      setData = _useState4[1];\n\n  var form = useForm();\n  var formList = new Array(100).fill(useForm());\n\n  var onFinish = function onFinish(formData) {\n    var firstFormId = HomeStore.firstFormId; // FormStore.submitData({ 'formId': firstFormId, 'data': formData })\n    // console.log(formList[0].getValues());\n\n    var checkArr = getCheckArr(form.schema);\n    var nData = formList[0].getValues();\n    console.log(data);\n    console.log({\n      'formId': firstFormId,\n      'data': _objectSpread(_objectSpread(_objectSpread({}, formData), nData), data),\n      'checkFieldIds': checkArr\n    }); // if (checkArr.length > 0) {\n    //   FormStore.submitDataCheck({ 'formId': firstFormId, 'data': formData, 'checkFieldIds': checkArr });\n    // } else {\n    //   FormStore.submitData({ 'formId': firstFormId, 'data': formData })\n    // }\n\n    console.log(checkArr);\n    form.resetFields();\n  };\n\n  useEffect(function () {\n    var firstFormId = HomeStore.firstFormId;\n    FormStore.getFormField({\n      formId: firstFormId\n    }).then(function () {\n      setSchema(restore(toJS(FormStore.formField), 'submit'));\n      console.log(restore(toJS(FormStore.formField)));\n      console.log(schema);\n    });\n  }, []);\n\n  var getItem = function getItem() {\n    var index = 0;\n\n    if (schema) {\n      for (var key in schema) {\n        if (Object.hasOwnProperty.call(schema, key)) {\n          var element = schema[key];\n\n          if (key != 'root') {\n            return /*#__PURE__*/React.createElement(_Tabs.TabPane, {\n              tab: key,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 56\n              },\n              __self: this\n            }, /*#__PURE__*/React.createElement(FormRender, {\n              schema: schema[key],\n              form: formList[index++],\n              style: {\n                overflowY: 'auto'\n              },\n              onFinish: onFinish,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 57\n              },\n              __self: this\n            }));\n          }\n        }\n      }\n    }\n  };\n\n  var handleChange = function handleChange(activeKey) {\n    var data = formList[0].getValues();\n\n    var iData = _objectSpread({}, data);\n\n    var nData = _objectSpread(_objectSpread({}, iData), data);\n\n    setData(nData);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form_layout\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(FormRender, {\n    schema: schema['root'],\n    widgets: {\n      self_divider: Self_divider\n    },\n    form: form,\n    onFinish: onFinish,\n    style: {\n      overflowY: 'auto'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }), /*#__PURE__*/React.createElement(_Tabs, {\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, getItem())), /*#__PURE__*/React.createElement(_Button, {\n    onClick: form.submit,\n    type: \"primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, \"\\u63D0\\u4EA4\"));\n});\nexport default inject(function (stores) {\n  return {\n    HomeStore: stores.HomeStore,\n    FormStore: stores.FormStore\n  };\n})(FormLayout);","map":{"version":3,"names":["React","useEffect","useState","FormRender","useForm","inject","observer","toJS","restore","getCheckArr","Self_divider","FormLayout","HomeStore","FormStore","schema","setSchema","data","setData","form","formList","Array","fill","onFinish","formData","firstFormId","checkArr","nData","getValues","console","log","resetFields","getFormField","formId","then","formField","getItem","index","key","Object","hasOwnProperty","call","element","overflowY","handleChange","activeKey","iData","self_divider","submit","stores"],"sources":["F:/documents/bl-device-manage-test/src/layouts/FormLayout/index.js"],"sourcesContent":["/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-02 03:21:54\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-19 04:21:10\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormLayout\\index.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\r\nimport React, { useEffect, useState } from 'react';\r\nimport FormRender, { useForm } from 'form-render';\r\nimport { Button, Tabs } from 'antd';\r\nimport { inject, observer } from 'mobx-react';\r\nimport { toJS } from 'mobx';\r\nimport { restore } from 'layouts/FormEdit/changeTool';\r\nimport { getCheckArr } from './formUtil';\r\nimport { Self_divider } from 'layouts/FormEdit/self_item/self_divider';\r\n\r\n\r\nconst FormLayout = observer(({ HomeStore, FormStore }) => {\r\n  const [schema, setSchema] = useState({});\r\n  const [data,setData] = useState({});\r\n  const form = useForm();\r\n  const formList = new Array(100).fill(useForm())\r\n  const onFinish = (formData) => {\r\n    const { firstFormId } = HomeStore;\r\n    // FormStore.submitData({ 'formId': firstFormId, 'data': formData })\r\n    // console.log(formList[0].getValues());\r\n    let checkArr = getCheckArr(form.schema)\r\n    let nData = formList[0].getValues()\r\n    console.log(data);\r\n    console.log(({ 'formId': firstFormId, 'data': {...formData,...nData,...data}, 'checkFieldIds': checkArr }));\r\n    // if (checkArr.length > 0) {\r\n    //   FormStore.submitDataCheck({ 'formId': firstFormId, 'data': formData, 'checkFieldIds': checkArr });\r\n    // } else {\r\n    //   FormStore.submitData({ 'formId': firstFormId, 'data': formData })\r\n    // }\r\n    console.log(checkArr);\r\n    form.resetFields();\r\n  }\r\n  useEffect(() => {\r\n    const { firstFormId } = HomeStore\r\n    FormStore.getFormField({ formId: firstFormId }).then(() => {\r\n      setSchema(restore(toJS(FormStore.formField), 'submit'))\r\n      console.log(restore(toJS(FormStore.formField)));\r\n      console.log(schema);\r\n    });\r\n  }, [])\r\n  const getItem = () => {\r\n    let index = 0;\r\n    if (schema) {\r\n      for (const key in schema) {\r\n        if (Object.hasOwnProperty.call(schema, key)) {\r\n          const element = schema[key];\r\n          if (key != 'root') {\r\n            return (\r\n              <Tabs.TabPane tab={key}>\r\n                <FormRender schema={schema[key]} form={formList[index++]} style={{ overflowY: 'auto' }} onFinish={onFinish} />\r\n              </Tabs.TabPane>\r\n            )\r\n          }\r\n\r\n        }\r\n      }\r\n    }\r\n  }\r\n  const handleChange = (activeKey) => {\r\n    let data = formList[0].getValues()\r\n    let iData = {...data}\r\n    let nData = {...iData,...data}\r\n    setData(nData);\r\n  }\r\n  return (\r\n    <div>\r\n      <div className='form_layout'>\r\n        <FormRender schema={schema['root']} widgets={{ self_divider: Self_divider }}\r\n          form={form} onFinish={onFinish} style={{ overflowY: 'auto' }} />\r\n        <Tabs onChange={handleChange}>\r\n          {\r\n            getItem()\r\n          }\r\n        </Tabs>\r\n      </div>\r\n      <Button onClick={form.submit} type=\"primary\">提交</Button>\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default inject((stores) => ({ HomeStore: stores.HomeStore, FormStore: stores.FormStore }))(FormLayout);"],"mappings":"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"},"metadata":{},"sourceType":"module"}