{"ast":null,"code":"import \"antd/lib/drawer/style\";\nimport _Drawer from \"antd/lib/drawer\";\nimport _slicedToArray from \"F:\\\\documents\\\\bl-device-manage-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"F:\\\\documents\\\\bl-device-manage-test\\\\src\\\\layouts\\\\FormEdit\\\\index.js\";\n\n/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-01 20:45:23\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-15 00:23:50\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormEdit\\index.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\nimport { BulbTwoTone, CloseOutlined } from '@ant-design/icons';\nimport FormRender, { useForm } from 'form-render';\nimport { defaultCommonSetting, defaultGlobalSettings, defaultSettings } from 'constants/field_config';\nimport Generator from 'fr-generator';\nimport { inject, observer } from 'mobx-react';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Link_item } from './self_item/link_item';\nimport { toJS } from 'mobx';\nimport './index.css';\nimport { exChange, restore } from './changeTool';\nimport { Submit_check } from './self_item/submit_check';\nimport { Self_divider } from './self_item/self_divider';\nvar FormEdit = observer(function (_ref) {\n  var HomeStore = _ref.HomeStore,\n      FormStore = _ref.FormStore;\n\n  // const [schema, setSchema] = useState({});\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      visible = _useState2[0],\n      setVisisble = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      lookItem = _useState4[0],\n      setLookItem = _useState4[1];\n\n  var ref = useRef();\n  var form = useForm(); // useEffect(() => {\n  //   FormStore.getFormField({ formId: HomeStore.firstFormId }).then(() => {\n  //     console.log(toJS(FormStore.formField));\n  //     console.log(restore(toJS(FormStore.formField)));\n  //     setSchema(restore(toJS(FormStore.formField)))\n  //   });\n  //   console.log(111);\n  // }, []);\n\n  var schema = {\n    \"properties\": {\n      \"1\": {\n        \"typeId\": \"0\",\n        \"check\": {},\n        \"title\": \"车间\",\n        \"type\": \"string\",\n        \"fieldId\": 1\n      },\n      \"45\": {\n        \"typeId\": \"0\",\n        \"check\": {\n          \"check_only\": true\n        },\n        \"title\": \"人员\",\n        \"type\": \"string\",\n        \"fieldId\": 45\n      },\n      \"46\": {\n        \"typeId\": \"0\",\n        \"check\": {},\n        \"title\": \"测试多条字段\",\n        \"type\": \"string\",\n        \"fieldId\": 46\n      },\n      \"47\": {\n        \"typeId\": \"0\",\n        \"check\": {},\n        \"title\": \"测试多条字段\",\n        \"type\": \"string\",\n        \"fieldId\": 47\n      },\n      \"48\": {\n        \"typeId\": \"0\",\n        \"check\": {},\n        \"title\": \"测试多条字段\",\n        \"type\": \"string\",\n        \"fieldId\": 48\n      },\n      \"49\": {\n        \"typeId\": \"0\",\n        \"check\": {},\n        \"title\": \"测试多条字段\",\n        \"type\": \"string\",\n        \"fieldId\": 49\n      }\n    },\n    \"displayType\": \"column\",\n    \"labelWidth\": 120,\n    \"type\": \"object\"\n  };\n\n  var look = function look() {\n    setLookItem(ref.current.getValue());\n    setVisisble(true);\n  };\n\n  var save = function save() {\n    var params = exChange(ref.current.getValue(), HomeStore.firstFormId); // FormStore.saveForm(params).then(() => {\n    //   message.success('保存成功')\n    // })\n\n    console.log(params);\n  };\n\n  var closeDrawer = function closeDrawer() {\n    setVisisble(false);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit_header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit_left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(BulbTwoTone, {\n    className: \"icon_edit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }), /*#__PURE__*/React.createElement(\"a\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }, \"\\u67E5\\u770B\\u65B0\\u624B\\u5F15\\u5BFC\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"edit_right\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"edit_look\",\n    onClick: look,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, \"\\u9884\\u89C8\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"edit_save\",\n    onClick: save,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, \"\\u4FDD\\u5B58\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"fr-generator-playground\",\n    style: {\n      height: '88vh'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(Generator // onSchemaChange={schema => console.log(schema)}\n  , {\n    ref: ref,\n    defaultValue: schema['root'],\n    settings: defaultSettings,\n    commonSettings: defaultCommonSetting,\n    globalSettings: defaultGlobalSettings,\n    extraButtons: [false, false, false, false],\n    controlButtons: [true, false, {\n      text: 'up',\n      onClick: function onClick(event, schema) {\n        return console.log(event, schema);\n      }\n    }],\n    hideId: true,\n    widgets: {\n      link_item: Link_item,\n      submit_check: Submit_check,\n      self_divider: Self_divider\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  })), /*#__PURE__*/React.createElement(_Drawer, {\n    placement: \"bottom\",\n    size: \"large\",\n    width: 1200,\n    visible: visible,\n    extra: /*#__PURE__*/React.createElement(CloseOutlined, {\n      onClick: closeDrawer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(FormRender, {\n    schema: lookItem,\n    form: form,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  })));\n});\nexport default inject(function (stores) {\n  return {\n    HomeStore: stores.HomeStore,\n    FormStore: stores.FormStore\n  };\n})(FormEdit);","map":{"version":3,"names":["BulbTwoTone","CloseOutlined","FormRender","useForm","defaultCommonSetting","defaultGlobalSettings","defaultSettings","Generator","inject","observer","React","useEffect","useRef","useState","Link_item","toJS","exChange","restore","Submit_check","Self_divider","FormEdit","HomeStore","FormStore","visible","setVisisble","lookItem","setLookItem","ref","form","schema","look","current","getValue","save","params","firstFormId","console","log","closeDrawer","height","text","onClick","event","link_item","submit_check","self_divider","stores"],"sources":["F:/documents/bl-device-manage-test/src/layouts/FormEdit/index.js"],"sourcesContent":["/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-01 20:45:23\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-15 00:23:50\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormEdit\\index.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\r\nimport { BulbTwoTone, CloseOutlined } from '@ant-design/icons';\r\nimport { Drawer, message } from 'antd';\r\nimport FormRender, { useForm } from 'form-render';\r\nimport { defaultCommonSetting, defaultGlobalSettings, defaultSettings } from 'constants/field_config';\r\nimport Generator from 'fr-generator';\r\nimport { inject, observer } from 'mobx-react';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { Link_item } from './self_item/link_item';\r\nimport { toJS } from 'mobx';\r\nimport './index.css'\r\nimport { exChange, restore } from './changeTool';\r\nimport { Submit_check } from './self_item/submit_check';\r\nimport { Self_divider } from './self_item/self_divider';\r\n\r\n\r\n\r\n\r\nconst FormEdit = observer(({ HomeStore, FormStore }) => {\r\n  // const [schema, setSchema] = useState({});\r\n  const [visible, setVisisble] = useState(false)\r\n  const [lookItem, setLookItem] = useState({})\r\n  const ref = useRef();\r\n  const form = useForm();\r\n  // useEffect(() => {\r\n  //   FormStore.getFormField({ formId: HomeStore.firstFormId }).then(() => {\r\n  //     console.log(toJS(FormStore.formField));\r\n  //     console.log(restore(toJS(FormStore.formField)));\r\n  //     setSchema(restore(toJS(FormStore.formField)))\r\n  //   });\r\n  //   console.log(111);\r\n  // }, []);\r\n  const schema = {\r\n    \"properties\": {\r\n        \"1\": {\r\n            \"typeId\": \"0\",\r\n            \"check\": {},\r\n            \"title\": \"车间\",\r\n            \"type\": \"string\",\r\n            \"fieldId\": 1\r\n        },\r\n        \"45\": {\r\n            \"typeId\": \"0\",\r\n            \"check\": {\r\n                \"check_only\": true\r\n            },\r\n            \"title\": \"人员\",\r\n            \"type\": \"string\",\r\n            \"fieldId\": 45\r\n        },\r\n        \"46\": {\r\n            \"typeId\": \"0\",\r\n            \"check\": {},\r\n            \"title\": \"测试多条字段\",\r\n            \"type\": \"string\",\r\n            \"fieldId\": 46\r\n        },\r\n        \"47\": {\r\n            \"typeId\": \"0\",\r\n            \"check\": {},\r\n            \"title\": \"测试多条字段\",\r\n            \"type\": \"string\",\r\n            \"fieldId\": 47\r\n        },\r\n        \"48\": {\r\n            \"typeId\": \"0\",\r\n            \"check\": {},\r\n            \"title\": \"测试多条字段\",\r\n            \"type\": \"string\",\r\n            \"fieldId\": 48\r\n        },\r\n        \"49\": {\r\n            \"typeId\": \"0\",\r\n            \"check\": {},\r\n            \"title\": \"测试多条字段\",\r\n            \"type\": \"string\",\r\n            \"fieldId\": 49\r\n        }\r\n    },\r\n    \"displayType\": \"column\",\r\n    \"labelWidth\": 120,\r\n    \"type\": \"object\"\r\n}\r\n  const look = () => {\r\n    setLookItem(ref.current.getValue())\r\n    setVisisble(true);\r\n  }\r\n  const save = () => {\r\n    let params = exChange(ref.current.getValue(), HomeStore.firstFormId)\r\n    // FormStore.saveForm(params).then(() => {\r\n    //   message.success('保存成功')\r\n    // })\r\n    console.log(params);\r\n  }\r\n  const closeDrawer = () => {\r\n    setVisisble(false)\r\n  }\r\n  return (\r\n    <>\r\n      <div className='edit_header'>\r\n        <div className='edit_left'>\r\n          <BulbTwoTone className='icon_edit' />\r\n          <a>查看新手引导</a>\r\n        </div>\r\n        <div className='edit_right'>\r\n          <button className='edit_look' onClick={look}>预览</button>\r\n          <button className='edit_save' onClick={save}>保存</button>\r\n        </div>\r\n      </div>\r\n      <div className=\"fr-generator-playground\" style={{ height: '88vh' }}>\r\n        <Generator\r\n          // onSchemaChange={schema => console.log(schema)}\r\n          ref={ref}\r\n          defaultValue={schema['root']}\r\n          settings={defaultSettings}\r\n          commonSettings={defaultCommonSetting}\r\n          globalSettings={defaultGlobalSettings}\r\n          extraButtons={[false, false, false, false]}\r\n          controlButtons={[true,false,{text:'up',onClick:(event,schema) => console.log(event,schema)}]}\r\n          hideId={true}\r\n          widgets={{\r\n            link_item: Link_item,\r\n            submit_check: Submit_check,\r\n            self_divider: Self_divider\r\n          }}\r\n        />\r\n      </div>\r\n      <Drawer\r\n        placement='bottom'\r\n        size='large'\r\n        width={1200}\r\n        visible={visible}\r\n        extra={\r\n          <CloseOutlined onClick={closeDrawer} />\r\n        }\r\n      >\r\n        <FormRender schema={lookItem} form={form} />\r\n      </Drawer>\r\n    </>\r\n  );\r\n});\r\n\r\nexport default inject((stores) => ({ HomeStore: stores.HomeStore, FormStore: stores.FormStore }))(FormEdit);\r\n"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,WAAT,EAAsBC,aAAtB,QAA2C,mBAA3C;AAEA,OAAOC,UAAP,IAAqBC,OAArB,QAAoC,aAApC;AACA,SAASC,oBAAT,EAA+BC,qBAA/B,EAAsDC,eAAtD,QAA6E,wBAA7E;AACA,OAAOC,SAAP,MAAsB,cAAtB;AACA,SAASC,MAAT,EAAiBC,QAAjB,QAAiC,YAAjC;AACA,OAAOC,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,QAAnC,QAAmD,OAAnD;AACA,SAASC,SAAT,QAA0B,uBAA1B;AACA,SAASC,IAAT,QAAqB,MAArB;AACA,OAAO,aAAP;AACA,SAASC,QAAT,EAAmBC,OAAnB,QAAkC,cAAlC;AACA,SAASC,YAAT,QAA6B,0BAA7B;AACA,SAASC,YAAT,QAA6B,0BAA7B;AAKA,IAAMC,QAAQ,GAAGX,QAAQ,CAAC,gBAA8B;EAAA,IAA3BY,SAA2B,QAA3BA,SAA2B;EAAA,IAAhBC,SAAgB,QAAhBA,SAAgB;;EACtD;EACA,gBAA+BT,QAAQ,CAAC,KAAD,CAAvC;EAAA;EAAA,IAAOU,OAAP;EAAA,IAAgBC,WAAhB;;EACA,iBAAgCX,QAAQ,CAAC,EAAD,CAAxC;EAAA;EAAA,IAAOY,QAAP;EAAA,IAAiBC,WAAjB;;EACA,IAAMC,GAAG,GAAGf,MAAM,EAAlB;EACA,IAAMgB,IAAI,GAAGzB,OAAO,EAApB,CALsD,CAMtD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACA,IAAM0B,MAAM,GAAG;IACb,cAAc;MACV,KAAK;QACD,UAAU,GADT;QAED,SAAS,EAFR;QAGD,SAAS,IAHR;QAID,QAAQ,QAJP;QAKD,WAAW;MALV,CADK;MAQV,MAAM;QACF,UAAU,GADR;QAEF,SAAS;UACL,cAAc;QADT,CAFP;QAKF,SAAS,IALP;QAMF,QAAQ,QANN;QAOF,WAAW;MAPT,CARI;MAiBV,MAAM;QACF,UAAU,GADR;QAEF,SAAS,EAFP;QAGF,SAAS,QAHP;QAIF,QAAQ,QAJN;QAKF,WAAW;MALT,CAjBI;MAwBV,MAAM;QACF,UAAU,GADR;QAEF,SAAS,EAFP;QAGF,SAAS,QAHP;QAIF,QAAQ,QAJN;QAKF,WAAW;MALT,CAxBI;MA+BV,MAAM;QACF,UAAU,GADR;QAEF,SAAS,EAFP;QAGF,SAAS,QAHP;QAIF,QAAQ,QAJN;QAKF,WAAW;MALT,CA/BI;MAsCV,MAAM;QACF,UAAU,GADR;QAEF,SAAS,EAFP;QAGF,SAAS,QAHP;QAIF,QAAQ,QAJN;QAKF,WAAW;MALT;IAtCI,CADD;IA+Cb,eAAe,QA/CF;IAgDb,cAAc,GAhDD;IAiDb,QAAQ;EAjDK,CAAf;;EAmDA,IAAMC,IAAI,GAAG,SAAPA,IAAO,GAAM;IACjBJ,WAAW,CAACC,GAAG,CAACI,OAAJ,CAAYC,QAAZ,EAAD,CAAX;IACAR,WAAW,CAAC,IAAD,CAAX;EACD,CAHD;;EAIA,IAAMS,IAAI,GAAG,SAAPA,IAAO,GAAM;IACjB,IAAIC,MAAM,GAAGlB,QAAQ,CAACW,GAAG,CAACI,OAAJ,CAAYC,QAAZ,EAAD,EAAyBX,SAAS,CAACc,WAAnC,CAArB,CADiB,CAEjB;IACA;IACA;;IACAC,OAAO,CAACC,GAAR,CAAYH,MAAZ;EACD,CAND;;EAOA,IAAMI,WAAW,GAAG,SAAdA,WAAc,GAAM;IACxBd,WAAW,CAAC,KAAD,CAAX;EACD,CAFD;;EAGA,oBACE,uDACE;IAAK,SAAS,EAAC,aAAf;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,gBACE;IAAK,SAAS,EAAC,WAAf;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,gBACE,oBAAC,WAAD;IAAa,SAAS,EAAC,WAAvB;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,EADF,eAEE;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,0CAFF,CADF,eAKE;IAAK,SAAS,EAAC,YAAf;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,gBACE;IAAQ,SAAS,EAAC,WAAlB;IAA8B,OAAO,EAAEM,IAAvC;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,kBADF,eAEE;IAAQ,SAAS,EAAC,WAAlB;IAA8B,OAAO,EAAEG,IAAvC;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,kBAFF,CALF,CADF,eAWE;IAAK,SAAS,EAAC,yBAAf;IAAyC,KAAK,EAAE;MAAEM,MAAM,EAAE;IAAV,CAAhD;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,gBACE,oBAAC,SAAD,CACE;EADF;IAEE,GAAG,EAAEZ,GAFP;IAGE,YAAY,EAAEE,MAAM,CAAC,MAAD,CAHtB;IAIE,QAAQ,EAAEvB,eAJZ;IAKE,cAAc,EAAEF,oBALlB;IAME,cAAc,EAAEC,qBANlB;IAOE,YAAY,EAAE,CAAC,KAAD,EAAQ,KAAR,EAAe,KAAf,EAAsB,KAAtB,CAPhB;IAQE,cAAc,EAAE,CAAC,IAAD,EAAM,KAAN,EAAY;MAACmC,IAAI,EAAC,IAAN;MAAWC,OAAO,EAAC,iBAACC,KAAD,EAAOb,MAAP;QAAA,OAAkBO,OAAO,CAACC,GAAR,CAAYK,KAAZ,EAAkBb,MAAlB,CAAlB;MAAA;IAAnB,CAAZ,CARlB;IASE,MAAM,EAAE,IATV;IAUE,OAAO,EAAE;MACPc,SAAS,EAAE7B,SADJ;MAEP8B,YAAY,EAAE1B,YAFP;MAGP2B,YAAY,EAAE1B;IAHP,CAVX;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,EADF,CAXF,eA6BE;IACE,SAAS,EAAC,QADZ;IAEE,IAAI,EAAC,OAFP;IAGE,KAAK,EAAE,IAHT;IAIE,OAAO,EAAEI,OAJX;IAKE,KAAK,eACH,oBAAC,aAAD;MAAe,OAAO,EAAEe,WAAxB;MAAA;QAAA;QAAA;MAAA;MAAA;IAAA,EANJ;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,gBASE,oBAAC,UAAD;IAAY,MAAM,EAAEb,QAApB;IAA8B,IAAI,EAAEG,IAApC;IAAA;MAAA;MAAA;IAAA;IAAA;EAAA,EATF,CA7BF,CADF;AA2CD,CA1HwB,CAAzB;AA4HA,eAAepB,MAAM,CAAC,UAACsC,MAAD;EAAA,OAAa;IAAEzB,SAAS,EAAEyB,MAAM,CAACzB,SAApB;IAA+BC,SAAS,EAAEwB,MAAM,CAACxB;EAAjD,CAAb;AAAA,CAAD,CAAN,CAAmFF,QAAnF,CAAf"},"metadata":{},"sourceType":"module"}