{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _slicedToArray from \"F:\\\\documents\\\\bl-device-manage-test\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"F:\\\\documents\\\\bl-device-manage-test\\\\src\\\\layouts\\\\FormLayout\\\\formData.js\";\n\n/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-02 03:21:54\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-07 18:30:33\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormLayout\\index.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\nimport React, { useEffect, useState } from 'react';\nimport FormRender, { useForm } from 'form-render';\nimport { inject, observer } from 'mobx-react';\nimport { toJS } from 'mobx';\nimport { restore } from 'layouts/FormEdit/changeTool';\nimport './index.css';\nimport { getCheckArr } from './formUtil';\nvar FormData = observer(function (_ref) {\n  var HomeStore = _ref.HomeStore,\n      FormStore = _ref.FormStore,\n      TableStore = _ref.TableStore;\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      schema = _useState2[0],\n      setSchema = _useState2[1];\n\n  var form = useForm();\n\n  var onFinish = function onFinish(formData) {\n    var firstFormId = HomeStore.firstFormId;\n    console.log({\n      'formId': firstFormId,\n      'data': formData,\n      'dataId': toJS(TableStore.detailData['data']['id'])\n    });\n    var checkArr = getCheckArr(form.schema);\n    console.log(checkArr);\n    console.log({\n      'formId': firstFormId,\n      'data': formData\n    });\n    console.log({\n      'formId': firstFormId,\n      'data': formData,\n      'dataId': toJS(TableStore.detailData['data']['id'])\n    }); // if (TableStore.formEdit == false) {\n    //   FormStore.setValue('formCopyVis', false)\n    //   TableStore.setDataPageModalVis(false);\n    //   FormStore.submitData({ 'formId': firstFormId, 'data': formData }).then(() => {\n    //     if (TableStore.model == 'subitAndManage') {\n    //       TableStore.getAllData({ formId: HomeStore.firstFormId }, 'myself')\n    //     } else {\n    //       TableStore.getAllData({ formId: HomeStore.firstFormId }, 'all')\n    //     }\n    //   })\n    // } else {\n    //   FormStore.changeData({ 'formId': firstFormId, 'data': formData, 'dataId': toJS(TableStore.detailData['data']['id']) }).then(() => {\n    //     TableStore.setValue('formEdit', false);\n    //     TableStore.getOneData({ 'formId': HomeStore.firstFormId, 'dataId': toJS(TableStore.detailData['data']['id']) })\n    //     if (TableStore.model == 'subitAndManage') {\n    //       TableStore.getAllData({ formId: HomeStore.firstFormId }, 'myself')\n    //     } else {\n    //       TableStore.getAllData({ formId: HomeStore.firstFormId }, 'all')\n    //     }\n    //   })\n    // }\n\n    form.resetFields();\n  };\n\n  var handleCancel = function handleCancel() {\n    TableStore.setValue('formEdit', false);\n  };\n\n  useEffect(function () {\n    FormStore.getFormField({\n      formId: HomeStore.firstFormId\n    }).then(function () {\n      setSchema(restore(toJS(FormStore.formField)));\n      console.log(toJS(FormStore.formField));\n      var formData = JSON.parse(toJS(TableStore.formData)['formData']);\n      form.setValues(formData);\n    });\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form_content\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form_main\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(FormRender, {\n    schema: schema['root'],\n    form: form,\n    onFinish: onFinish,\n    style: {\n      overflowY: 'auto'\n    },\n    debug: \"true\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form_footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }, /*#__PURE__*/React.createElement(_Button, {\n    onClick: form.submit,\n    type: \"primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, \"\\u63D0\\u4EA4\"), TableStore.formEdit && /*#__PURE__*/React.createElement(_Button, {\n    onClick: handleCancel,\n    style: {\n      marginLeft: '20px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, \"\\u53D6\\u6D88\")));\n});\nexport default inject(function (stores) {\n  return {\n    HomeStore: stores.HomeStore,\n    FormStore: stores.FormStore,\n    TableStore: stores.TableStore\n  };\n})(FormData);","map":{"version":3,"names":["React","useEffect","useState","FormRender","useForm","inject","observer","toJS","restore","getCheckArr","FormData","HomeStore","FormStore","TableStore","schema","setSchema","form","onFinish","formData","firstFormId","console","log","detailData","checkArr","resetFields","handleCancel","setValue","getFormField","formId","then","formField","JSON","parse","setValues","overflowY","submit","formEdit","marginLeft","stores"],"sources":["F:/documents/bl-device-manage-test/src/layouts/FormLayout/formData.js"],"sourcesContent":["/*\r\n * @Author: EmberCCC 1810888456@qq.com\r\n * @Date: 2022-07-02 03:21:54\r\n * @LastEditors: EmberCCC 1810888456@qq.com\r\n * @LastEditTime: 2022-07-07 18:30:33\r\n * @FilePath: \\bl-device-manage-test\\src\\layouts\\FormLayout\\index.js\r\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n */\r\nimport React, { useEffect, useState } from 'react';\r\nimport FormRender, { useForm } from 'form-render';\r\nimport { Button } from 'antd';\r\nimport { inject, observer } from 'mobx-react';\r\nimport { toJS } from 'mobx';\r\nimport { restore } from 'layouts/FormEdit/changeTool';\r\nimport './index.css'\r\nimport { getCheckArr } from './formUtil';\r\n\r\nconst FormData = observer(({ HomeStore, FormStore, TableStore }) => {\r\n  const [schema, setSchema] = useState({});\r\n  const form = useForm();\r\n  const onFinish = (formData) => {\r\n    const { firstFormId } = HomeStore;\r\n    console.log({ 'formId': firstFormId, 'data': formData, 'dataId': toJS(TableStore.detailData['data']['id']) });\r\n    let checkArr = getCheckArr(form.schema);\r\n    console.log(checkArr);\r\n    console.log({ 'formId': firstFormId, 'data': formData });\r\n    console.log({ 'formId': firstFormId, 'data': formData, 'dataId': toJS(TableStore.detailData['data']['id']) });\r\n    // if (TableStore.formEdit == false) {\r\n    //   FormStore.setValue('formCopyVis', false)\r\n    //   TableStore.setDataPageModalVis(false);\r\n    //   FormStore.submitData({ 'formId': firstFormId, 'data': formData }).then(() => {\r\n    //     if (TableStore.model == 'subitAndManage') {\r\n    //       TableStore.getAllData({ formId: HomeStore.firstFormId }, 'myself')\r\n    //     } else {\r\n    //       TableStore.getAllData({ formId: HomeStore.firstFormId }, 'all')\r\n    //     }\r\n    //   })\r\n    // } else {\r\n    //   FormStore.changeData({ 'formId': firstFormId, 'data': formData, 'dataId': toJS(TableStore.detailData['data']['id']) }).then(() => {\r\n    //     TableStore.setValue('formEdit', false);\r\n    //     TableStore.getOneData({ 'formId': HomeStore.firstFormId, 'dataId': toJS(TableStore.detailData['data']['id']) })\r\n    //     if (TableStore.model == 'subitAndManage') {\r\n    //       TableStore.getAllData({ formId: HomeStore.firstFormId }, 'myself')\r\n    //     } else {\r\n    //       TableStore.getAllData({ formId: HomeStore.firstFormId }, 'all')\r\n    //     }\r\n    //   })\r\n    // }\r\n    form.resetFields();\r\n  }\r\n  const handleCancel = () => {\r\n    TableStore.setValue('formEdit', false);\r\n  }\r\n  useEffect(() => {\r\n    FormStore.getFormField({ formId: HomeStore.firstFormId }).then(() => {\r\n      setSchema(restore(toJS(FormStore.formField)))\r\n      console.log(toJS(FormStore.formField));\r\n      const formData = JSON.parse(toJS(TableStore.formData)['formData'])\r\n      form.setValues(formData);\r\n    });\r\n  }, [])\r\n  return (\r\n    <div className='form_content'>\r\n      <div className='form_main'>\r\n        <FormRender schema={schema['root']} form={form} onFinish={onFinish} style={{ overflowY: 'auto' }} debug='true' />\r\n      </div>\r\n      <div className='form_footer'>\r\n        <Button onClick={form.submit} type=\"primary\">提交</Button>\r\n        {\r\n          TableStore.formEdit && <Button onClick={handleCancel} style={{ marginLeft: '20px' }}>取消</Button>\r\n        }\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default inject((stores) => ({ HomeStore: stores.HomeStore, FormStore: stores.FormStore, TableStore: stores.TableStore }))(FormData);"],"mappings":"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"},"metadata":{},"sourceType":"module"}